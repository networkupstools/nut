# Network UPS Tools: man

prefix		= @prefix@
exec_prefix	= @exec_prefix@

MANDIR		= $(DESTDIR)@mandir@

INSTALLCMD  = @INSTALL@
INSTALLMODE = 0644

MAN3_PAGES  = upscli_connect.3 upscli_disconnect.3 \
		upscli_readline.3 upscli_sendline.3 \
		upscli_splitname.3 upscli_strerror.3
MAN5_PAGES  = ups.conf.5 upssched.conf.5 upsd.conf.5 upsmon.conf.5 \
		upsd.users.5
MAN8_PAGES  = upsc.8 upsrw.8 upscmd.8 upslog.8 upssched.8 \
		upsmon.8 upsd.8 nutupsdrv.8 upsdrvctl.8

DRIVERPAGES = \
	al175.8		\
	apcsmart.8	\
	bcmxcp.8 	\
	belkin.8 	\
	belkinunv.8	\
	bestuferrups.8	\
	bestups.8 	\
	bestfcom.8	\
	cpsups.8	\
	cyberpower.8	\
	dummy-ups.8	\
	etapro.8	\
	everups.8	\
	fentonups.8 	\
	genericups.8	\
	ippon.8		\
	isbmex.8	\
	liebert.8	\
	masterguard.8	\
	metasys.8	\
	mge-shut.8	\
	mge-utalk.8	\
	mustek.8	\
	nitram.8	\
	oneac.8		\
	powercom.8 	\
	megatec.8	\
	safenet.8	\
	sms.8		\
	solis.8		\
	tripplite.8	\
	tripplitesu.8	\
	upscode2.8	\
	victronups.8

SNMPPAGES = snmp-ups.8

USBPAGES = @USBPAGES@

DRIVER_BUILD_LIST = @DRIVER_BUILD_LIST@

CGI_MAN5 = hosts.conf.5 upsset.conf.5 upsstats.html.5
CGI_MAN8 = upsset.cgi.8 upsstats.cgi.8 upsimage.cgi.8

all: $(MAN5_PAGES) $(MAN8_PAGES)

clean:

distclean: clean

# DRIVER_INSTALL_TARGET is usually "all-drivers" but changes into
# some-drivers when using 'configure --with-drivers=...'

install: all install-man-dirs @DRIVER_INSTALL_TARGET@
	@for f in $(MAN5_PAGES) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man5; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man5; \
	done
	@for f in $(MAN8_PAGES) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
	done

# make the directories for these things

install-man-dirs:
	@if (test ! -d $(MANDIR)) then \
		echo ../install-sh -d $(MANDIR) || exit 1;\
		../install-sh -d $(MANDIR) || exit 1;\
	fi
	@if (test ! -d $(MANDIR)/man5) then \
		echo ../install-sh -d $(MANDIR)/man5 || exit 1;\
		../install-sh -d $(MANDIR)/man5 || exit 1;\
	fi
	@if (test ! -d $(MANDIR)/man8) then \
		echo ../install-sh -d $(MANDIR)/man8 || exit 1;\
		../install-sh -d $(MANDIR)/man8 || exit 1;\
	fi

# install every driver man page
all-drivers:
	@for f in $(DRIVERPAGES) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
	done

# install just the pages for the drivers that were built
some-drivers:
	@for f in $(DRIVER_BUILD_LIST) ; do \
		if (test -f $$f.8) \
		then \
			echo $(INSTALLCMD) -m $(INSTALLMODE) $$f.8 $(MANDIR)/man8; \
			$(INSTALLCMD) -m $(INSTALLMODE) $$f.8 $(MANDIR)/man8; \
		fi \
	done

# just the CGI program man pages
install-cgi-man: install-man-dirs
	@for f in $(CGI_MAN5) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man5; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man5; \
	done

	@for f in $(CGI_MAN8) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
	done

# just the upsclient man pages
install-lib-man: 
	@if (test ! -d $(MANDIR)) then \
		echo ../install-sh -d $(MANDIR) || exit 1;\
		../install-sh -d $(MANDIR) || exit 1;\
	fi
	@if (test ! -d $(MANDIR)/man3) then \
		echo ../install-sh -d $(MANDIR)/man3 || exit 1;\
		../install-sh -d $(MANDIR)/man3 || exit 1;\
	fi
	@for f in $(MAN3_PAGES) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man3; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man3; \
	done

# just the SNMP (snmp-ups) man page(s)
install-snmp-man:
	@if (test ! -d $(MANDIR)) then \
		echo ../install-sh -d $(MANDIR) || exit 1;\
		../install-sh -d $(MANDIR) || exit 1;\
	fi
	@if (test ! -d $(MANDIR)/man8) then \
		echo ../install-sh -d $(MANDIR)/man8 || exit 1;\
		../install-sh -d $(MANDIR)/man8 || exit 1;\
	fi
	@for f in $(SNMPPAGES) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
	done

# just the USB (hidups, newhidups and energizerups) man page(s)
install-usb-man:
	@if (test ! -d $(MANDIR)) then \
		echo ../install-sh -d $(MANDIR) || exit 1;\
		../install-sh -d $(MANDIR) || exit 1;\
	fi
	@if (test ! -d $(MANDIR)/man8) then \
		echo ../install-sh -d $(MANDIR)/man8 || exit 1;\
		../install-sh -d $(MANDIR)/man8 || exit 1;\
	fi
	@for f in $(USBPAGES) ; do \
		echo $(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
		$(INSTALLCMD) -m $(INSTALLMODE) $$f $(MANDIR)/man8; \
	done

driver-man-helper:
	@for f in $(DRIVERPAGES) ; do \
		BN=`echo $$f | cut -f 1 -d .`; \
		echo -n "\\fB$$BN\\fR(8), "; \
	done
	@echo ""

