2.4.0-pre2

Wed Jan 21 12:03:25 UTC 2009 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - configure.in: 2.4.0-pre2
 
Wed Jan 21 11:59:52 UTC 2009 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - NEWS: last completion

Wed Jan 21 11:46:34 UTC 2009 / Arnaud Quette <ArnaudQuette@Eaton.com>

 * NUT Python support udpate:
   - scripts/python/*: fix the missing PyNUTClient name update
   - scripts/python/README: some more completion
   (thanks to David Goncalves for the patch)

Sat Jan 17 23:05:22 UTC 2009 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp,bcmxcp_usb: Add readings from extended limit block, like max min
    voltage for transfer to trim/boost and to battery. Moved this code into separated
    functions. Also corrected power to voltage in the previous change, and some spelling.
    Change driver version to 0.21.

Tue Jan 15 00:15:23 UTC 2009 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp,bcmxcp_usb: Add input.voltage.nominal, Change driver version to 0.20.

Wed Jan 14 23:43:00 UTC 2009 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp,bcmxcp_usb: Change driver version to 0.19.

Wed Jan 14 23:35:10 UTC 2009 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp.c: Add ups.power value.

Wed Jan 14 21:45:10 UTC 2009 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp.c: Changed status info to include OL with BYPASS, BOOST, TRIM.
    Add some more meters like power and current.nominal (max).

Wed Jan 14 22:22:51 UTC 2009 / Arnaud Quette <aquette.dev@gmail.com>

 - tools/Makefile.am: fix the name of the "dist-hook" rule, which triggers the
   USB files regeneration upon calling "make dist"

Wed Jan 14 21:59:47 UTC 2009 / Arnaud Quette <aquette.dev@gmail.com>

 * Eaton update:
   - drivers/{mge-shut.c,mge-shut.h,mge-hid.c}, data/driver.list:
     - add more models, like Nova AVR 625 and 1250, and renamed models,
     - if a model name can't be matched, concatenate iProduct and iModel. The
       next step is to only manage exceptions since the above rule is now the
       standard.
     
Wed Jan 14 21:55:47 UTC 2009 / Arnaud Quette <aquette.dev@gmail.com>

 * Rework the NUT Python support tree:
   - scripts/python/module: moved a level up since PyNUT will also provide a
     configuration class in the future,
   - scripts/python/module/PyNUT.py: revert the name from PyNUTClient to PyNUT,
   - scripts/python/module/test_nutclient.py: fix the import name to PyNUT,
   - scripts/python/app: moved a level up,
   - scripts/python/README: some update and completion,
   - scripts/python/Makefile.am: update for the reworked tree,
   - AUTHORS, COPYING, NEWS: update the PyNUT name and fix typo.

Tue Jan  6 13:55:30 UTC 2009 / Charles Lepple <clepple@gmail.com>

 - m4/nut_check_os.m4: change dist_get_flavor to os_get_name.
 - ChangeLog: update year to 2009 for some commits.

Sat Jan  3 00:35:10 UTC 2009 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - man/bcmxcp.8: Changed some info that was wrong in the man page.
   And added info about outlet control.

Fri Jan  2 22:05:32 UTC 2009 / Arnaud Quette <aquette.dev@gmail.com>

 * Integrate the NUT client Python module and application from David Goncalves:
   - scripts/python/client/app/*: integrate the NUT-Monitor Python application, 
   - scripts/python/client/module/*: integrate the PyNUTClient Python module,
   - scripts/python/client/README: add some documentation,
   - scripts/python/Makefile.am: add the distribution rule,
   - configure.in: also output scripts/python/Makefile, 
   - COPYING: modified to reflect the GPL 2+ and GPL 3+ (python/client/*) files, 
   - LICENSE-GPL2, LICENSE-GPL3: distribute the most recent version of the GNU
     GENERAL PUBLIC LICENSE,
   - UPGRADING: mention the licensing difference,
   - NEWS: mention the integrated NUT client Python support,
   - AUTHORS: mention David's work.

Fri Jan  2 21:29:20 UTC 2009 / Charles Lepple <clepple@gmail.com>

 - man/blazer.8: small wording and punctuation changes,
 - man/dummy-ups.8: fix wording of sections written prior to repeater mode.
 - man/nutupsdrv.8: update driver list,

Wed Dec 31 22:32:35 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - man/bcmxcp.8, man/bcmxcp_usb.8: mention man/bcmxcp_usb.8 in man/bcmxcp.8, and
   reword some sentences.

Wed Dec 31 10:00:38 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite-hid.c: add another TrippLite SmartOnline SU1500RTXL2UA
   USB ID.

Mon Dec 29 14:57:52 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/safenet.[ch]: add 'offdelay' and 'ondelay' parameters to allow
   timed shutdowns
 - man/safenet.8: manual update to include above changes and to cleanup the
   formatting

Sat Dec 27 16:28:48 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c, man/tripplite_usb.8: Fix man page description (as
   in previous changeset) for tripplite_usb, and reword part of introduction.
   (No code changes, only comments.)

Sat Dec 27 16:17:34 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - man/libupsclient-config.8, man/powerpanel.8, man/richcomm_usb.8: normalize
   the dash between the program name and the one-line description.

2.4.0-pre1

Wed Dec 24 14:32:42 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - configure.in: 2.4.0-pre1

Wed Dec 24 14:13:52 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - NEWS, README, UPGRADING: first update round for 2.4.0.
 
Wed Dec 24 13:47:21 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - drivers/bcmxcp.c: remove the experimental tag, to the profit of stable, as
   per the maintainer comment (Kjell Claesson), and bump the driver release. 
 
Wed Dec 24 13:26:31 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - man/powerman-pdu.8: add a configuration example to illustrate the use of
   the "port" in ups.conf

Wed Dec 24 13:12:42 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

- clients/upsclient.h: remove the backward compatibility for client application,
  through the "UPSCONN" typedef. Developers must now use "UPSCONN_t" for the
  client structure, as advertized since NUT 2.2.1.

Wed Dec 24 12:53:22 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - docs/configure.txt: missing bump of the date, from the previous commit
 - docs/macros.txt: add the missing documentation for NUT_CHECK_LIBPOWERMAN and
   NUT_CHECK_OS

Wed Dec 24 12:24:35 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 * final removal of the energizerups driver (broken):
   - drivers/energizerups.c, man/energizerups.8, m4/nut_check_hiddev.m4: removed
   - configure.in, data/driver.list, docs/macros.txt, docs/configure.txt,
     drivers/Makefile.am, man/Makefile.am, man/nutupsdrv.8: updated

Wed Dec 24 12:15:53 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 * final removal of the al175 driver (broken):
   - drivers/al175.c, man/al175.8, docs/al175-vars.txt: removed
   - MAINTAINERS, data/driver.list, docs/Makefile.am, drivers/Makefile.am,
     man/Makefile.am, man/nutupsdrv.8: updated

Wed Dec 24 11:26:32 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - conf/nut.conf.sample: add a generic NUT configuration file, to standardize
   the various distro specific files (/etc/default/nut, /etc/sysconfig/nut, ...)
   This allows to declare the MODE NUT is running, to start the right component.
 - conf/Makefile.am: include nut.conf.sample

Wed Dec 24 11:08:21 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - drivers/powerman-pdu.c: minor adjustment following the last API change
 - man/powerman-pdu.8: minor completion

Fri Dec 19 12:02:34 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - mge-hid.c: add Protection Station, and the master/slave mode.

Tue Dec 23 21:01:12 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/richcomm_usb: rewritten driver formerly known as lakeview_usb

Tue Dec 23 14:53:05 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/powerpanel: functionality added/changed
   - text mode driver supports setting 'ondelay' and 'offdelay' (to allow
     delayed shutdown and start)
   - upsdrv_shutdown() function falls back from 'shutdown.return' to
     'shutdown.stayoff' and 'shutdown.reboot' (depending on line state)
     which is needed for older text mode protocol units that can't do this
     by themselves
   - renamed 'test.failure.start' and 'test.failure.stop' to
     'test.battery.start.quick' and 'test.battery.stop' respectively
  * man/powerpanel.8: manual page updated to reflect the above changes

Mon Dec 22 21:23:23 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - data/driver.list: complete compatibility information from OpenUPSmart
   (http://openupsmart.sourceforge.net) since these are all supported by the
   megatec driver (Centralion rebranded units)

Fri Dec 19 17:30:14 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - server/upsd: Shed clients after one minute of inactivity, to prevent that
   stalled clients keep resources occupied.

Thu Dec 18 20:15:24 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * introduce the upsdrv_info_t structure: this is a structure containing all the
   common driver information, like name, version, author(s) and development
   status (patch provided by Arnaud Quette).
   - main.ch: declare the upsdrv_info_t structure and a generic upsdrv_banner
     function to print the banner information.
   - drivers/*: create and fill the upsdrv_info_t entry and remove the
     upsdrv_banner function. Bump the release version. Remove header files that
     only contain the driver version (this information is now available through
     upsdrv_info_t upsdrv_info that is filled in every driver)
   - docs/new-drivers.txt: add and update the according information.

Thu Dec 18 12:13:22 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - clients/Makefile.am: apply nut-openssl_linkage_fix.diff (from Oden Eriksson)

Tue Dec 16 21:55:24 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - configure.in, m4/nut_check_os.m4: declare and use the NUT_CHECK_OS m4 macro
   to determine the exact system name

Mon Dec 15 13:14:32 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - docs/upsd.users.sample, docs/upsmon.conf.sample: make the base configuration
   examples more coherent accross the various files, and more easy to use for
   the predominant use case (simple configuration)
    
Mon Dec 15 10:07:55 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - Add tcp-wrappers support to the upsd server. This will restore the
   functionality of allowfrom that was lost when the ACL mechanism was
   removed with r1233. It is now again possible to grant users access by
   source IP for commands that require to be logged into the server.

Thu Dec 11 04:12:54 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - Apply other portion of Steffen Plotner's patch to fetch ambient temperature
   for APC SNMP module (APCC_OID_IEM_TEMP value). Should also fix Alioth bug
   #310613.

Wed Dec 10 08:48:27 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - tools/nut-usbinfo.pl: remove the hexadecimal suffix for the HAL file, and
   complete the script for the new richcomm_usb and blazer_usb drivers
 - ups-nut-device.fdi.in, libhid.usermap and nut-usbups.rules.in: regenerated
   with the updated script

Tue Dec  9 21:44:19 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/blazer.[ch]: core for Megatec/Q1 protocol.
 - drivers/blazer_ser.c: driver for serial interface UPS.
 - drivers/blazer_usb.c: driver for USB interface UPS.
 - man/blazer.8: combined manual page for serial/USB

Thu Dec  4 21:47:42 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/richcomm_usb.[ch]: Added new richcomm_usb driver based on the
   lakeview_usb driver (using libusb)

Tue Dec  2 00:57:23 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers: added lakeview_usb to svn:ignore.
 - drivers/lakeview_usb.c: set the 'experimental' flag for lakeview_usb.

Tue Dec  2 00:41:00 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 * added lakeview_usb driver.

Wed Nov 26 22:18:43 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * Power Distribution Unit (PDU) preliminary support (2): add support for a wide
   range of PDUs through the Powerman project, and its libpowerman.
   - drivers/powerman-pdu.[ch]: created a driver that use libpowerman to
     interact with the Powerman daemon,
   - drivers/Makefile.am: add the necessary rules for the powerman-pdu driver,
   - man/Makefile.am: add the necessary rules for the powerman-pdu manpage,
   - man/powerman-pdu.8: add the manpage to document powerman-pdu,
   - man/nutupsdrv.8: add a reference to powerman-pdu 
   - configure.in, m4/nut_check_libpowerman.m4: add and use a macro to detect
     libpowerman and its flags, and propose a --with-powerman configure option,
   - data/driver.list: add the devices supported by Powerman.

Thu Nov 20 09:40:24 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 * Power Distribution Unit (PDU) preliminary support (1):
   - drivers/eaton-aphel-mib.h: add support for Eaton ePDUs (Managed and
     Monitored) and some Aphel models.
   - drivers/raritan-mib.h: add support for some Raritan PDUs.
   These two MIBs add the new "device.*" collection, as presented on nut-upsdev
   mailing list.
   - drivers/snmp-ups.c:
     - switch to a 2 decimals precision for numeric values
     - improve reactivity for stop requests
     - differentiate "unknown mib" and "device not detected" (which is equal to
       "no supported mib found"), to prepare for the probe flag
     - trace the requested OID in nut_snmp_get()
   - drivers/snmp-ups.h: bump the driver release to 0.44, and update the
     load_mib2nut() prototype.
   - drivers/Makefile.am: add the new MIB files
   - data/driver.list: add the supported PDUs from Eaton, Aphel and Raritan,
   - man/snmp-ups.8: document the new MIBS and devices,
   - doc/new-names.txt: add some new variables, in the outlet collection, to
     report PDUs values.

Tue Nov 25 13:37:18 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/apccmib.h: Use OID ending in .1 for APC temperature and humidity
   probes. (Patch courtesy of Steffen Plotner; confirmed by George Ross.)

Mon Nov 24 13:05:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec.c: Use new usb_device_id_t and is_usb_device_supported()
   for selection of the subdriver.
 - drivers/usb-common.c: Unclutter is_usb_device_supported().

Mon Nov 24 02:48:54 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - data/driver.list: Add Chloride Desk Power 650 UPS to list. (Thanks to Cyril
   Pawelko for the report.)

Sun Nov 23 20:16:25 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/libusb.c: If claiming a USB device fails (possibly after a couple
   of retries), bail out. This should catch permissions (and other) problems
   that need user intervention to be resolved.

Thu Nov 20 20:08:23 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - docs/new-names.txt: change ambient temperature/humidity variable names to
   make clear that these are limit values, not minimum/maximum values seen
 - drivers/<various>: apply the above

Thu Nov 20 09:24:07 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - energizerups: tag as broken_driver, so scheduled for removal by 2.4.0

Mon Nov 17 19:52:28 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/Makefile.am: it looks like r1567 didn't take care of this for all
   BuildBots, retry

Mon Nov 17 19:06:08 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/Makefile.am: fix changes from r1566 that broke building

Mon Nov 17 09:56:47 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 * dummy-ups repeater mode:
   - drivers/dummy-ups.c, drivers/Makefile.am, man/dummy-ups.8: add a new
     running mode, called "repeater". The existing "dummy" mode which loads its
     definition from a file, is still suppported. The new "repeater" mode allows
     to get and relay (forward) data from a NUT server, using libupsclient.
     This can be useful for supervision purposes. On big network setup, this can
     also allow some load sharing between several upsd instances, using a point
     to point communication with the UPS.
     In a soon future, this will also help in creating the meta (virtual) device
     approach.
     This is still a work in progress, since instant commands and settable
     values are not yet supported.
 - drivers/dummy-ups.c: call pconf_finish() when we are done with parsing the
   definition file in "dummy" mode.
 - drivers/dummy-ups.h: bump driver release to 0.05.

Sun Nov 16 18:06:08 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/safenet.c: display debug information in text mode, rather than
   in hexadecimal mode

Sun Nov 16 18:04:03 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/dstate.c: add debug commands

Sat Nov 15 23:58:44 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * Drivers removal (cpsups, nitram): powerpanel is now officially taking over
   - nitram: the original author confirmed the powerpanel takeover (thanks to
     Olivier Albiez)
   - cpsups: this driver was broken for a long time, and powerpanel already
     covers all features (thanks to Arjen de Korte).

Sat Nov 15 23:40:32 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - ltmain.sh: update to GNU libtool 2.2.4
 - configure.in: add AC_CONFIG_MACRO_DIR([m4]) macro

Sat Nov 15 22:24:16 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * USB maintenance improvements: create a set of USB helpers, to start laying
   down a common ground for USB support. This provide a standard way to declare
   supported USB devices, and the extraction of these info to generate the
   various USB files (HAL, Hotplug and udev)
   - drivers/usb-common.{c,h}: with a structure
     (usb_device_id), a macro (USB_DEVICE) and a matching function (
     is_usb_device_supported())
   - drivers/*: {usb,hid}*: 
     - implement a usb_device_id struct instance,
     - use it in the various claiming/matching function through 
       is_usb_device_supported(),
     - bump the [sub]drivers release.     
   - drivers/Makefile.am: integrate usb-common.{c,h}
   - tools/nut-usbinfo.pl: created a Perl script that extract all "USB_DEVICE"
     pattern from the drivers/ directory files, and generate:
     ups-nut-device.fdi.in, libhid.usermap and nut-usbups.rules.in.
   - tools/Makefile.am: created with a call to nut-usbinfo.pl upon "make dist",
     only if Perl is present.
   - Makefile.am: list tools in SUBDIRS,
   - scripts/hal/ups-nut-device.fdi.in, scripts/hotplug/libhid.usermap,
     scripts/udev/nut-usbups.rules.in: regenerate using "make dist"
   - doc/new-drivers.txt: document these USB helpers.
      
Tue Nov 11 20:25:12 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/apcsmart.[ch]: Improve support for some vintage Matrix-UPS
   models [patch by Marcus Wellhardh]

Sun Nov  9 15:34:24 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/upscode2.c: Some weird characters broke the compilation.
   Fixed.

Sun Now  9 13:45:25 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - docs/new-drivers.txt, drivers/serial.[ch]: Add ser_get_buf() that
   wraps around the select_read().
 - drivers/safenet.c, drivers/upscode2.c: Use ser_get_buf() instead
   of select_read().

Fri Nov  7 19:46:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/safenet.c: Optimized communication with UPS and updated
   handling of instcmds.

Thu Nov  6 20:54:15 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/upscode2.c: Commit r1549 'fixed' a non-existing problem.
   This should be taken care of properly now.

Wed Nov  5 21:20:52 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - INSTALL, docs/powersaving.txt, data/cmdvartab, data/evolution500.dev, 
   drivers/<various>: Rename the Main Outlet from "outlet.0" to "outlet"
   according to the Powersave specification.

Wed Nov  5 07:47:02 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/upscode2.c: Fix problem with reading replies on slow systems.

Mon Nov  3 12:37:56 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/powerp-bin.c, drivers/usbhid-ups.c: Fix compiler warnings.

Mon Nov  3 12:31:19 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/<various>: Changes required by commit r1542.

Mon Nov  3 08:37:41 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/upscode2.c: Change required by commit r1542.

Sun Nov  2 12:34:29 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/safenet.c, drivers/powerp-bin.c, drivers/powerp-txt.c:
   Fix typo and unknown escape sequences.

Sun Nov  2 12:21:03 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/powerpanel: Allow three polls to fail, before declaring data
   stale. Improve debugging of the serial communication [commit r1542].

Sun Nov  2 12:17:56 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/safenet.c: Improve debugging of the serial communication.

Sun Nov  2 12:14:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - docs/new-drivers.txt, drivers/serial.[ch]: The return code of the
   ser_get_*() functions is now 0 on timeouts. This allows drivers to tell
   the difference between an error that occurred reading from the serial
   port and timeouts while reading from the UPS. The ser_send() and
   ser_send_pace() functions return -1 on errors, so the return value
   should be signed, not unsigned.
 - drivers/megatec_usb.c: Return code for ser_send_pace() is signed.

Mon Oct 20 11:31:14 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec.c, man/megatec.8: Adds a "battvoltmult" parameter to the
   megatec driver (based on a patch from Carlos Rodrigues)

Sun Oct 19 09:59:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite-hid.c, scripts/hal/ups-nut-device.fdi,
   scripts/hotplug/libhid.usermap, scripts/udev/nut-usbups.rules.in: Add
   an additional productid for Tripp-Lite SMART2200RXML2U.

Sat Oct 18 17:15:20 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - data/driver.list: Add the Delta GES602N. Reported working by Jerome Benoit.

Tue Oct 14 14:00:00 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - driver.list: add the full Eaton range (addressing MGE Office Protection
   Systems), and the Protection Station from MGE Office Protection Systems.

Fri Oct 10 20:43:32 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - data/driver.list, drivers/tripplite-hid.c, scripts/hal/ups-nut-device.fdi
   scripts/hotplug/libhid.usermap, scripts/udev/nut-usbups.rules.in: add 
   support for Tripp-Lite AVR750U (patch provided by Raphael Geissert)
 - data/driver.list: add support for HP PowerTrust 2997A

Fri Sep 26 00:24:26 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - data/driver.list: added several UPS models.
 - man/megatec_usb.8: fixed battvolts description as suggested by
   Jamie Thompson.

Wed Sep 24 18:18:31 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.[ch]:
   - Fix server side variables 'ups.delay.start' and 'ups.delay.shutdown'
     so that they won't show if the underlying HID path needed to use
     them is not available.
   - The 'load.on' and 'load.off' commands only need 'ups.delay.start'
     and 'ups.delay.shutdown' respectively (not both).
   - Fallback to 'load.off.delay' if both 'shutdown.return' and
     'shutdown.reboot' fail to shutdown the UPS.

Mon Sep 22 18:01:50 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite-hid.c: Add support for HP R/T2200 G2 (which seems to
   be a re-branded Tripp Lite SMART2200RMXL2U) and revert change to add
   hp-hid subdriver.

Sun Sep 21 07:52:27 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/hp-hid.c: Fix typo.

Sat Sep 20 19:41:07 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - data/driver.list, scripts/{hal/hotplug/udev}: Add support for
   Hewlett Packard R/T 2200 UPS.

Sat Sep 20 19:03:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/{Makefile.am,hp-hid.c,usbhid-ups.c}:
   Add HID subdriver for Hewlett Packard R/T 2200 UPS.

Sat Sep 20 18:04:50 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/apc-hid.c: Fix typo.

Sat Sep 20 09:29:05 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/apc-hid.c: Add enviromental sensor

Fri Sep 19 11:59:27 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - common/state.c,drivers/main.c,include/extstate.h: Make it possible to
   permanently override a variable set by the UPS (if it returns wrong static
   data) or to set a default value (if some static data is missing, either in
   the driver or in the UPS).

Fri Sep 19 11:50:35 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/mge-xml.c: Change from numerical to text message in test result.

Sat Sep 6 09:52:20 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp.c: Changed some comments and TODO list.

Sat Aug 23 20:11:10 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp.c: Set the right version number that should be 0.15.

Sat Aug 23 19:48:20 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

  - drivers/bcmxcp.[ch]: Added info from loadsegment. Also changed so the
    instantcommand for outlet switching is only visible if you have it.
    Changed revision for the driver to 0.14.

Thu Aug 21 19:37:40 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - common/Makefile.am: restore revision number for development builds

Thu Aug 21 19:08:59 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - <various>/Makefile.am: libtool fixes (patch provided by Stanislav
   Brabec, from openSUSE)

Fri Aug 15 23:48:38 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: Increase send retries to 10 (as needed by some
   protocol 2001 units)

Thu Aug  7 09:39:57 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite.[ch]: significantly improved failure mode handling and
   also basic checks of data validity (from Nicholas J. Kain)

Mon Aug  4 12:49:13 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - docs/shutdown.txt: fix documentation bug

Wed Jul 30 03:18:34 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/libusb.c: add prototype for libusb_close() for Solaris (pointed out
   by John-Mark Gurney)

Sun Jul 13 15:18:23 UTC 2008 / Carlos Rodrigues <cefrodrigues@gmail.com>

 - drivers/megatec.c: don't parse replies with sscanf (better input handling)

Sun Jul 13 12:30:02 UTC 2008 / Carlos Rodrigues <cefrodrigues@gmail.com>

 - drivers/megatec.c: better handling of strange input

Thu Jul 10 12:22:54 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/apcsmart.[ch]: patch to recognize older APC Smart-UPS 1250
   (patch provided by Don Harvie)

Mon Jul  7 19:00:00 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - m4/nut_check_libhal.m4, drivers/main-hal.c: test for g_timeout_add_seconds
   availability (need Glib 2.14) (reported by Jordi Mallach, from Debian)

Fri Jul  4 14:15:24 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/apcsmart.c: print the firmware identifier for older Smart-UPS
   models, if it is successfully retrieved. (driver v1.99.9)

Fri Jul  4 12:04:55 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - clients/upsclient.c: fix a compilation error due to the missing include
   of timehead.h (reported by Thomas Jarosch)

Thu Jul  3 12:49:01 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - data/driver: add Cyber Power Systems Value range (400E, 600E and 800E)
   (reported by Thomas Backman)
   
Tue Jul  1 12:33:43 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - man/al175.8: fix a manpage error
   (reported by Debian Lintian QA tool)

Tue Jul  1 12:33:43 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - man/Makefile.am: also distribute libupsclient-config.1
   (reported by Lab10)

Mon Jun 30 07:54:36 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/main.c: only call upsdrv_cleanup() if upsdrv_initups() was
   successful (to prevent cleaning up non-existant drivers)

Sat Jun 28 19:41:23 UTC 2008 / Carlos Rodrigues <cefrodrigues@gmail.com>

 * drivers/megatec.c:
   - Add parameters to set DTR and RTS explicitly in case the default values
     don't work.
   - Allow the UPS load value to be undefined.
   - Send an "I" command before detection because some models seem to
     require it.
   - Do nothing in upsdrv_cleanup if the file descriptor is invalid (to shut
     up a warning displayed when running "megatec -h").

Sat Jun 28 14:25:42 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - configure.in, scripts/hal/Makefile.am: generate ups-nut-device.fdi based on
   Arjen's autoconf test.

Fri Jun 27 20:27:35 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - scripts/hal/ups-nut-device.fdi: since HAL 0.5.11, "info.bus" is no longer
   used and is replaced by "info.subsystem"

Sun Jun 22 18:09:03 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - debian/rules, debian/changelog: changed version to disambiguate trunk from
   branches/Testing, and added rule to put netxml-ups driver in nut-xml
   package.

Thu Jun 19 02:26:23 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/bestfcom.c: UPS reports runtime in minutes. Patch provided by Chris
   Adams; tested against Ferrups 18KVA.

Tue Jun 17 02:36:44 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - (various): ignore auto-generated files

Tue Jun 17 02:20:48 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - scripts/misc/nut.bash_completion: added some more completion functions.

Sun Jun  8 11:14:02 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - conf/upsd.conf.sample: add MAXCONN parameter to the sample
   configuration file

Sun Jun  8 11:11:53 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite_usb.c: don't use upsdrv_cleanup() on reconnection

Sun Jun  8 10:56:21 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/mge-xml.c, man/netxml-ups.8: use <GET_OBJECT> page instead
   of <XML_SUMMARY_PAGE> to read parameters from the UPS

Thu May 15 11:26:21 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - data/driver.list: add Trust UPS 1300VA Management PW-4130M
   (reported by Kristian Wiklund)

Mon May 12 12:30:24 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - packaging/debian/Makefile.am: copied missing po/ entries from
   branches/Testing (apparently I didn't look too far).

Mon May 12 01:16:12 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - packaging/debian/Makefile.am: removed entries for files which do not exist
   in SVN.

Mon May 12 01:09:30 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - packaging/debian/Makefile.am: reformatted

Sun May 11 17:24:33 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - m4/nut_check_libhal.m4: Fix syntax error (introduced in rev 1485) that was
   causing configure to fail.

Wed May  7 15:35:06 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - m4/nut_check_libhal.m4: prepare for the hal.pc improvements.

Wed May  7 12:32:12 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - drivers/main-hal.c: fix the calls to dbus_send_reply
   (reported by Stanislav Brabec, SuSE)

Wed May  7 11:01:06 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 * Synchronisation with (backport from) the Testing branch:
   - clients/Makefile.am: fix the use of libupsclient [r1474]
   - packaging/debian: synchronize with the official package and update
     according to the many changes in 2.2.2. For more information, refer to
     packaging/debian/changelog [r1457]
   - NEWS, UPGRADING: backport of the Testing versions
   - ChangeLog: trimmed everything previous to 2.2.0
 
Tue May  6 03:20:07 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - m4/nut_check_libhal.m4: fix printing of default Callout directory.

Tue May  6 02:38:20 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - m4/nut_check_libhal.m4: default to ${libdir}/hal, since ${libdir} might not
   point to /usr/lib/hal when running e.g. make distcheck.

Tue May  6 02:35:09 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - configure.in: tell autoconf to generate packaging/mandriva/nut.spec

Sun May  4 12:43:56 UTC 2008 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 - data/driver.list: added two models supported by megatec
 - drivers/megatec.c: don't show a temp reading if it's clearly bogus

Wed Apr 30 15:14:34 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - m4/nut_check_libhal.m4: fix the HAL addon install path on SuSE x86_64
   (from Stanislav Brabec, SuSE)
   
Wed Apr 30 08:40:55 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - packaging/mandriva: remove generated nut.spec file

Tue Apr 29 19:16:13 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: delay initialization of the context buffer
   until we know we have a connection

Tue Apr 29 19:13:22 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - packaging/opensuse/nut.spec.in: fix broken shell scripting

Tue Apr 29 08:37:07 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - packaging/opensuse/nut.spec.in: nut-hal package should conflict
   with nut package to make sure that if people update an existing
   installation nut must be uninstalled prior to installing nut-hal

Tue Apr 29 08:19:52 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - packaging/opensuse/Makefile.am,nut.spec.in: change numeric NUT
   port to service name
 - configure.in: forgot to add opensuse

Tue Apr 29 07:47:34 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - packaging/Makefile.am,README: forgot to add opensuse

Tue Apr 29 07:44:59 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - man/Makefile.am: backport from Testing [r1456]

Tue Apr 29 07:30:01 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - packaging/opensuse: add packaging for SuSE / openSUSE

Tue Apr 22 19:55:53 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: functions in common/common.c will not be
   available to clients that are linked to the library

Tue Apr 22 19:45:34 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - man/Makefile.am: fix dependencies for libupsclient-config.1 and
   netxml-ups.8

Tue Apr 22 17:58:12 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/usbhid-ups: only check once for input reports in
   upsdrv_updateinfo() to prevent lockups if the UPS floods the
   driver (some Tripplite units will generate one each time you
   ask them)

Mon Apr 14 09:48:54 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: add internal fault as separate alarm status,
   removed unused status and alarm bits

Mon Apr 14 07:05:09 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/main-hal.c,main.[ch],updrvctl.c: cleanup signal handling

Mon Apr 14 06:58:39 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - server/upsd.c: cleanup signal handling, removed -f option
   (programs won't background when running in debug mode)

Mon Apr 14 06:47:51 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: don't spam the syslog if we can't connect to
   the UPS

Tue Apr  8 19:24:46 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: cleanup the driver a bit

Tue Apr  8 18:32:30 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/main.[ch]: added some variables in list of globals
 - drivers/serial.c,drivers/snmp-ups.h: implemented the above

Mon Apr  7 19:14:16 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: use alarm() to replace the behaviour of
   ne_set_connect_timeout() for neon < 0.27.0 (this will save us
   questions from people that complain that upsd is declaring the
   driver stale)

Mon Apr  7 14:10:32 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: require neon-0.25.0 or newer (essential
   functionality won't be available in earlier versions)

Mon Apr  7 12:50:47 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: some autoconf magic added to selectively build
   with connect timeout, depending on the neon library installed (it
   will build for neon < 0.27.0, but will inform the user about the
   risk of failed (re)connect attempts)

Sun Apr  6 13:20:47 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: add some sanity checks

Sun Apr  6 12:29:52 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - man/netxml-ups.8: be more verbose in explanation of the 'timeout'
   value that can be specified in 'ups.conf'

Sun Apr  6 11:41:03 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: require connectivity test to pass and fix
   some minor cosmetic things

Sun Apr  6 11:04:02 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - common/state.c,include/state.h: don't use recursion if we are only
   walking through a tree or list

Sun Apr  6 08:30:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: use connect with timeout to prevent the
   server declaring us stale (requires neon-0.27.0 or newer)

Sat Apr  5 16:03:25 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: add connectivity test

Sat Apr  5 13:25:03 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: resurrected an old version of agiler
   subdriver for testing.

Fri Apr  4 21:09:16 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/main.c: check for the exit flag

Fri Apr  4 21:04:52 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: added some debugging code and a timeout
   parameter that allows changing the network timeouts
 - m4/nut_check_libneon.m4: use pkg-config to reveal the version
   of the installed neon library

Thu Apr  3 20:43:29 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/main.c: keep polling the filedescriptors until the poll
   interval has elapsed or the 'extrafd' draws the attention
   (previously, anything happening on the filedescriptors, would
   trigger upsdrv_updateinfo() too, even errors)
 - drivers/dstate.[ch]: see the above
 - drivers/dstate-hal.[ch]: added sleep here, to limit the polling
   rate (previously, the driver would completely ignore the poll
   interval and would run upsdrv_updateinfo() without any delays
   in between)

Wed Apr  2 20:41:38 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: lower timeout value for communication with the
   UPS to 3 seconds and increase number of retries allowed to 10
   before complaining about stale data (also fix minor issue with
   cleanup of the driver)
 - man/netxml-ups.8: update manual page to reflect how this driver
   deals with 'pollinterval'

Tue Apr  1 20:15:44 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upscmd: be a good little client that cleans up after itself

Tue Apr  1 20:01:45 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - common/state.c: make the command list sorted (so that commands
   will be listed in alphabetic order by upscmd)

Mon Mar 31 19:53:47 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsc: be a good little client that cleans up after itself

Mon Mar 31 11:31:49 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * clients/upsclient.[ch]:
   - add read buffer (so that we can read in larger chunks, instead
     of character by character)
   - the context buffer is now statically allocated (since we always
     need it)
   - code cleanup

Fri Mar 28 20:20:08 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

- drivers/dstate.[ch]: use doubly linked list for connections to the
  driver (to speedup adding/removing connections) and code cleanup

Fri Mar 28 20:01:24 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - server/sstate.c,upsd.c: don't terminate connection on EAGAIN,
   EINTR or if no data was received (these are not really errors)

Thu Mar 27 21:36:54 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/dstate.c: fix memory leak (minor)

Thu Mar 27 20:24:54 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: default to 5 seconds if pollinterval is not
   specified (to prevent overloading older NMCs by default)

Tue Mar 25 20:09:12 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: partially revert r1394 (breaks the LIST
   command, that depends on reading replies line-by-line)

Tue Mar 25 19:08:11 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * server/upsd:
   - improved performance for servers handling many clients by using
     a doubly (instead of a singly) linked list for the clients (so
     that we don't have to traverse the whole list if we want to add
     or remove a client)
   - let the parser deal with fragmented reads from the server and
     the clients (don't duplicate this in the server), just feed it
     with the raw data
   - cleaned up code

Tue Mar 25 18:47:41 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: performance improvement

Tue Mar 25 18:40:00 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: lower read timeout from the default (neon)
   value of 60 seconds to 10 seconds (to prevent the server from
   declaring the driver stale)

Fri Mar 21 09:59:23 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - replace "--with-lib" by "--with-dev" since we now always distribute
   the shared version of libupsclient. This change allow to build and
   install the static version of libupsclient, along with its helpers
   and manpages.

Sun Mar 23 20:10:15 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - common/common.c,include/common.h: added select_read/write that
   combine a call to select() and read()/write() so that we don't
   need to duplicate this code
 - clients/upsclient.c,drivers/serial.c: use the above

Sun Mar 23 17:00:53 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/dstate.c: revert r1383 that horribly broke the drivers
   (sorry about that, didn't quite test this enough)

Fri Mar 21 21:04:53 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - server/upsd: revert changes from r1379 which seem to have a bad
   side effect on highly loaded servers

Fri Mar 21 20:54:31 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/dstate.c: send data to the server with a timeout (so that
   it doesn't have to accept everything in one write action)

Fri Mar 21 20:48:27 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: handle all communications with the server
   through upscli_sendline/readline to prevent blocking on I/O
   calls when the server is not responding (while still allowing
   it a couple of seconds to reply).

Thu Mar 20 20:11:55 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: missing return statement caused the driver to
   ignore communication failures (will now report properly after three
   consecutive failures)

Thu Mar 20 19:59:23 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - server/upsd: add clients last in the list of filedescriptors to
   poll, so that the server won't become unresponsive if the maximum
   number of connections is exceeded

Wed Mar 19 20:15:20 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: Don't assume the server will answer immediately,
   but instead use select() to see if data is available. This should fix
   the problem that 'upsmon' loses connections on highly loaded servers.
   Likewise, also check if the server is ready to receive data before
   trying to send it.

Tue Mar 18 19:51:53 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - server/upsd: use poll() instead of select() to allow larger numbers
   of clients to connect to the server than FD_SETSIZE allows (maximum
   number can be specified with MAXCONN in upsd.conf, defaults to
   FD_SETSIZE)

Mon Mar 17 13:43:21 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - data/cmdvartab: add obsolete 'beeper.on' and 'beeper.off' commands
   with an informative message to use the new replacements

Thu Mar 13 15:25:32 UTC 2008 / Arnaud Quette <ArnaudQuette@Eaton.com>

 - clients/upsstats.c, conf/upsstats.html.sample: fixed the Internet
   Explorer compatibility. It doesn't like HTML attribute values on a
   separate line (as for STATUSCOLOR), though it is HTML 4.0 compliant.

Mon Mar 10 10:02:36 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups:
   - allow subdrivers to override the 'shutdown.(return|stayoff)'
     commands that are 'composed' in the driver
   - add new 'load.(on|off).delay' commands to allow the above (will
     implicitly define 'load.(on|off)' command with a delay value of
     '0')
   - add description of how the driver will deal with these commands
     in the documentation for the HID subdrivers

Sun Mar  9 02:45:35 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - Patches from George Ross to support ups.temperature in upsstats.cgi
 - update config.guess, config.sub and install.sh

Sun Mar  9 02:31:15 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/bestups.[ch]: Don't show ups.temperature if it starts with an 'X'.
   (Updated driver version to 1.04)

Sat Mar  8 20:52:51 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/powerpanel: update man page and OP series conversion
   functions

Sat Mar  8 20:01:24 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsc.c: reverse this change from r1320, that causes upsc
   to segfault when running it with the -l or -L options

Fri Mar  7 19:17:59 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: extend three phase support, rename 'bypass.*'
   variables to standard 'input.bypass.*'

Fri Mar  7 19:11:07 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/mge-hid.c:
   - add support for three phase
   - detect UPS type
 - drivers/usbhid-ups.[ch]: handle manual/service and automatic
   bypass separately (will show up as BYPASS in 'ups.status' and
   informative message will be shown in 'ups.alarm'
 - docs/new-names.txt: add missing variables that are already
   widely used
 - data/cmdvartab: add description for missing variables and add
   missing units

Wed Mar  5 21:05:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/mge-xml: This driver has been replaced by the netxml-ups
   driver

Wed Mar  5 16:11:02 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * Integrated Power Management (HAL integration)
   - general rework of {dstate,main}-hal.ch, using GMainLoop,
   - done some code cleaning and removal,
   - add support for DBus methods (with Shutdown and SetBeeper),
   - complete the documentation to mention the DBus (RW) interface.

Tue Mar  4 21:35:58 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/netxml-ups:
   - handle manual/service and automatic bypass separately (will
     show up as BYPASS in 'ups.status' and informative message
     will be shown in 'ups.alarm'
   - add (experimental) variables for bypass input (unofficial
     variable names)
   - handle unexpected whitespace characters in url better

Tue Mar  4 21:30:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - man/nutupsdrv.8: explain what happens when debugging is enabled
   for drivers

Mon Mar  3 19:57:11 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/usbhid-ups: Quite a few users have already complained
   about the driver 'failing to start' due to this.

Mon Mar  3 10:38:14 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: I should read 'new-names.txt' more carefully.
   The indexes for 3-phase systems don't have square brackets.

Mon Mar  3 10:09:42 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * driver/usbhid-ups:
   - only use defaults for server side variables on startup (and
     don't reset them to the defaults when reconnecting)
   - only register 'shutdown.restart' and 'shutdown.stayoff', if
     we have 'ups.delay.start' and 'ups.delay.shutdown' (when
     'DelayBeforeShutdown' and 'DelayBeforeStartup' are available)

Mon Mar  3 09:50:30 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/netxml-ups:
   - fix the 'ups.serial' for devices that report this number in
     PRODUCT_INFO
   - don't inherit value from previous object if no value is set
     for the current object
   - 'battery.current' was off by a factor of 10

Sun Mar  2 13:40:02 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: Apply the change from 'ups.delay.start' to
   'ups.timer.start' to this driver as well (the first is writeable,
   while the second is a read-only countdown timer)

Sun Mar  2 13:13:23 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups:
   - change 'ups.delay.start' and 'ups.delay.shutdown' to server
     side variables that control the ondelay and offdelay for
     the 'shutdown.return' and 'shutdown.stayoff' instcmd's
   - create 'ups.timer.(start|shutdown|reboot)' that indicate the
     time before these respective timers elapse (read-only)
   - remove the test for ondelay>offdelay (the values can be
     changed at runtime too and for some devices we already know
     there may be legitimate reasons for doing so)

Sun Mar  2 12:39:48 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: The ne_parse_uri() function doesn't handle
   parsing uri's that don't contain a method how to connect. It is
   mandatory to specifiy this.

Sun Mar  2 12:23:29 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/libhid.c: Fix incorrect size (usage paths are of type
   HIDNode_t, not long)

Sat Mar  1 19:28:19 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/hidparser.c, drivers/hidtypes.h, drivers/libhid.h:
   - reformattedhidparsersothatitnowhasmorewhitespace (and conforms
     to the preferred coding style regarding indentation)
   - removed nObject and nReports from HIDParser_t since they were
     not used (and would overflow if more than 255 Objects or Reports
     are found anyway)
   - changed the type of HIDNode_t from unsigned int to uint32_t

Sat Mar  1 19:24:09 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/liebert-hid.c: Add support for some additional params.

Sat Mar  1 19:01:16 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: Use strtok_r() instead of strtok(), so that
   we don't accidentally interfer with the caller (strtok() is not
   guaranteed to be reentrant).

Sat Mar  1 18:47:52 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/netxml-ups:
   - fix decimal conversion (decimal was lost in conversion).
   - ignore variables that should never be zero (but that are).
   - split date and time.
   - some status bits are reported as numeric (0/1) and text (yes/no)
     depending on the model (accept both).
   - add a few more variables.

Fri Feb 29 21:16:21 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/mge-hid.c: HID path 'UPS.PowerSummary.(Config)Voltage'
   is only indicating the 'battery.voltage(.nominal)' on specific
   models/series, ignore these otherwise.
 - drivers/usbhid-ups.h: DEFAULT_ONDELAY and DEFAULT_OFFDELAY should
   match the values mentioned in 'usbhid-ups.8'. This was changed
   (incorrectly) in r1113.

Thu Feb 28 21:10:47 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups: Add 3-phase variables (based on MGE Galaxy).

Thu Feb 28 15:57:24 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/bestups:
   - add 'input.voltage.nominal' and 'output.voltage.nominal'
   - new option 'battvoltmult' allows setting a multiplication
     factor for devices that report only a fraction of the battery
     string voltage.
   - corrected 'battery.voltage.nominal' to comply with NUT standard.
   - user overrides should be unconditional, the driver should not
     attempt to silently correct/ignore values.
   - display 'battery.charge' with resolution of one decimal (which is
     probably way more than the precision of the calculation).
   - updated man page.

Tue Feb 26 19:24:48 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/hidparser.c: If a HID path for a report ends in 0x00000000,
   it will not be made available. These are continuations of previous
   objects (that we can't handle anyway). Instead, we will only use
   them to calculate the size of the report.
 - drivers/libhid.c: We no longer need to skip the reports above.

Mon Feb 25 20:38:45 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/hidparser.c: Allocate twice the maximum number of reports
   we expect (MAX_REPORTS), to allow for bogus/duplicate reports.

Mon Feb 25 13:04:24 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - man/Makefile.am: Include netxml-ups man page in distribution.

Mon Feb 25 12:34:32 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * data/driver.list:
   - add APC BACK-UPS XS LCD (reported by Chad Miller),
   - USB completion for Powerware (for PW5115 and PW9120)

Sun Feb 24 21:36:23 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - man/netxml-ups.8: Add manual page for 'netxml-ups' driver (shameless
   copy from the 'mge-xml' man page with some additional comments).

Sun Feb 24 20:31:59 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - driver/mge-xml.c: Add manufacturer string if we succesfully parsed
   the '/mgeups/product.xml' page.
 - driver/netxml-ups.c: Supply user credentials when logging into the
   UPS. Not functional, since we have no functionality that needs this
   (yet).

Sun Feb 24 19:56:54 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - common/serial.c: Cleanup some of the serial I/O functions (no
   functional changes).

Sun Feb 24 11:17:36 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - netxml-ups: Add autoconf and configure magic.

Sat Feb 23 21:27:10 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups.[ch]: Add 'ups.status' and 'ups.alarm' processing.
 - drivers/mge-xml.c: Create mapping between XML and NUT variables.

Fri Feb 22 20:11:33 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - man/usbhid-ups.8: Added cautionary warning for unattended shutdowns.

Fri Feb 22 19:14:04 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/*.c: The upscli_disconnect() function does no longer LOGOUT
   from the server. Adding this to the clients that use this to prevent
   the server from logging warnings.

Fri Feb 22 18:45:54 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/mge-hid.c: HU_FLAG_ABSENT implies that the value isn't stored
   in the UPS, so the HU_FLAG_STATIC is redundant.
 - drivers/usbhid-ups.c: Allow changing server side variables (bugfix).

Fri Feb 22 09:52:24 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/*-hid.c: Commit r1314 accidentally removed the 'shutdown.stop'
   command, where it should have been 'shutdown.stayoff' that needed to
   be removed.
 - drivers/usbhid-ups.c: The 'shutdown.return' and 'shutdown.stayoff'
   commands are now 'composite' commands. If the UPS follows the HID PDC
   specification, these act as supposed to be by the NUT standards.

Wed Feb 20 22:31:56 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/skel.c: Added setvar function. 

Wed Feb 20 22:31:38 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups.[ch],drivers/mge-xml.c: Integration work in NUT
   started. Supports currently one (1) variable. Work in progress!

Wed Feb 20 21:29:54 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/*-hid.c: Removed 'shutdown.return' and 'shutdown.stop' commands
   from the USB HID subdrivers, since they currently don't conform to the
   NUT standards for these commands.
 - drivers/usbhid-ups.c: The 'upsdrv_shutdown()' function now uses the
   'load.on' and 'load.off' commands to accomplish the same as with the
   previous 'shutdown.return' and 'shutdown.stop' commands (HID commands
   to the UPS are identical).

Tue Feb 19 20:41:51 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/netxml-ups.[ch],drivers/mge-xml.[ch]: Sneak preview for the
   new XML driver based on the 'neon' library. Work in progress!

Mon Feb 18 16:07:35 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * Integrated Power Management (HAL integration) (port from Testing r1309):
   - fix the reporting of the battery technology,
   - fix the reporting of levels by adding a warning and a critical level,
   - report battery granularity,
   - only report the charging status if the battery charge is below 100 %,
   - report the current battery computed state (capacity_state),
   - report battery.alarm.{design,unit}

Sun Feb 17 22:40:34 UTC 2008 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 * drivers/megatec.c:
   - cancel any pending shutdowns soon after detecting the
     UPS to avoid tripping the bogus OFF flag test
   - set datastale() only after 3 failed polling cycles.

Sun Feb 17 19:58:59 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - data/driver.list: added Unitek Alpha 1250xD and Belkin Active
   Battery Backup BU30 series to the list.

Wed Feb 13 20:51:45 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/libmge-xml.[ch]: fix memory leak in libmge_xml_close(), use
   upsfd to store descriptor for the socket we use for communication
   with the UPS.

Thu Feb 14 08:47:32 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - man/megatec_usb.8, man/upscode2.8, man/bcmxcp.8, man/bcmxcp_usb.8,
   man/solis.8, man/rhino.8: fix various errors

Wed Feb 13 19:47:32 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/genericups.c: fix previous patch

Wed Feb 13 19:38:44 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/genericups.c: output signal overrides must be handled
   in upsdrv_initups(), since we might go straight to upsdrv_shutdown()
   afterwards.

Wed Feb 13 02:10:27 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/bestfcom.c: Patch from Chris Adams to accept output from older
   Ferrups models.

Tue Feb 12 04:43:11 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/libmge-xml.c: Remove MSG_NOSIGNAL, as it is non-standard, and
   apparently not necessary in this case.

Sun Feb 10 16:06:59 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - (clients|drivers|server)/Makefile.am: only add target specific
   LDFLAGS if the target is enabled (in case something is really broken
   and the linker chokes on it)

Sun Feb 10 15:32:27 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - configure.in,(clients|drivers|server)/Makefile.am: only add target
   specific CFLAGS if the target is enabled [Alioth Bug #310582]

Sat Feb  9 19:44:41 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/serial.[ch]: pass the buffer argument as (void *) pointer,
   rather than as a (char *) or (unsigned char *) where possible, to
   shut up compiler warnings about mismatches in signedness and to
   allow passing other variable types too without typecasting
 - drivers/megatec_usb.c: adapt the ser_get_line() function to the
   above

Sat Feb  9 11:40:50 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - no comment (it has to do with the HAL support once more)
   [Alioth Bug #304156]

Sat Feb  9 10:50:09 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - fix HAL support installation yet once again [Alioth Bug #304156]

Sat Feb  9 00:21:49 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - packaging/debian/rules: updated for HAL path changes

Fri Feb  8 23:59:24 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: enable code to set Unit ID.

Fri Feb  8 19:53:01 UTC 2008 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 - drivers/megatec.c: flush buffers before ser_send_*/ser_get_* to avoid a
   possible loss of synchronization if the buffer happens to have garbage.

Fri Feb  8 19:38:01 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/powerp-bin.c: add conversion functions and variable lists
   for the CyberPower OP series (autodetected)

Fri Feb  8 19:25:30 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - fix HAL support installation again [Alioth Bug #304156]

Fri Feb  8 07:08:49 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - common/common.c,include/common.h: cleanup and change the arguments
   to the upsdebug_hex() function so that it no longer requires casting
   to an unsigned char.

Wed Feb  6 21:07:54 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/Makefile.am: fix typo in previous commit.

Wed Feb  6 20:24:07 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/powerpanel: break up existing powerpanel driver source,
   so that there is a main driver body and separate source files for
   the binary and text mode protocols.

Tue Feb  5 09:15:56 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - finally fix the HAL support installation [Alioth Bug #304156]

Sun Feb  3 21:10:11 UTC 2008 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 - data/driver.list: a couple more models supported by megatec.

Sun Feb  3 19:35:01 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - m4/nut_check_libhal.m4: use variable install path to complete the
   fix for Alioth Bug #304156

Sun Feb  3 17:43:40 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - man/upsd.conf.5: LISTEN directive defaults to 127.0.0.1 now that ACLs have
   been removed.

Sun Feb  3 11:27:38 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/nitram.c: Array subscript out of range.

Sat Feb  2 02:45:28 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - scripts/hal, etc.: changed so that the fix for Alioth Bug #304156 actually
   gets processed.

Fri Feb  1 23:02:55 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * HAL support: [Alioth Bug #304156]
   - m4/nut_check_libhal: detect addon and .fdi install paths,
   - drivers/Makefile.am: modified to install the hald-addon-* in the
     right directory,
   - scripts/hal/Makefile.am: created to install the .fdi file in the
     right directory,
   - scripts/hal/20-ups-nut-device.fdi: renamed to ups-nut-device.fdi.

Fri Feb  1 19:46:34 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * man/nutupsdrv.8:
   - mention that "-a" argument is mandatory when calling the driver directly.
   - complete the Drivers list

Fri Feb  1 19:27:43 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - man/dummy-ups.8: remove the reference to direct driver launching and
   make some other update. [Alioth Bug #310543]
   
Fri Feb  1 15:22:04 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - include/common.h: move the config.h include before timehead.h so
   that this last use it (thanks to Thomas Jarosch).

Wed Jan 30 04:43:17 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: (rev 0.17) Added preliminary code to test setting
   the unit ID.

Wed Jan 30 04:23:47 UTC 2008 / Charles Lepple <clepple@gmail.com>

 * packaging/debian:
   - Fix makefile.am so that all files currently in the directory get
     distributed (compat was missing from the tarball)
   - Comment out a line in rules which was causing .debs to fail

Tue Jan 29 01:51:16 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - driver.list: update compatibility information for Oneac models (list all
   combinations for the more recent models, and just the base model name for
   units from ~2001).

Tue Jan 29 00:36:35 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - man/tripplite_usb.8: Regenerate man page for tripplite_usb(8)

Tue Jan 29 00:31:55 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: (rev 0.16) More debugging and logging for
   protocol 0004.

Mon Jan 28 11:28:32 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * driver.list: add compatibility information for
   - Atlantis Land and Mustek Powermust Office 650 (reported by
     Andrea Zicchetti)
   - Oneac XAU models

Mon Jan 28 09:25:12 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * dummy-ups update:
   - variable values are not truncated anymore when loading the
     .dev file,
   - relax the variable existance checking to allow adding valid
     variables that are not listed,
   - complete the manual page (dummy-ups.8),
   - fix a typo error in the sample .dev file,
   - bump the driver version to 0.04.
 
Mon Jan 28 07:36:41 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: Don't clear the magic number after disconnecting
   (prevents the upscli_strerr from displaying useful information).

Sun Jan 27 22:03:23 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: (rev 0.15) Completely enable some commands for
   protocol 0004.

Sun Jan 27 21:26:38 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsclient.c: Use upscli_disconnect() if the connection can't be
   established or is lost to release the memory that was allocated by
   upscli_connect() (fixes memory leak when connection to the server is lost).
 - clients/upsmon.c: The upscli_disconnect() is now the opposite of
   upscli_connect() and no longer attempts to LOGOUT from the server, so
   we now need to explicitly send this command.

Sun Jan 27 19:54:38 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: (rev 0.14) Fix input.frequency for protocol 0004.

Sat Jan 26 21:16:45 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * clients/Makefile.am:
   - set libupsclient version to 1.0.0
   - use the shared version of libupsclient for LDADD
 - docs/protocol.txt: mention libupsclient

Sat Jan 26 21:16:45 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - lib/Makefile.am: only install libupsclient-config if pkg-config support is
   disabled.
 - man/libupsclient-config.1: created (Debian Lintian QA report)

Sat Jan 26 16:40:01 UTC 2008 / Charles Lepple <clepple@gmail.com>

 * driver/powercom.[ch], man/powercom.8: Powercom update v0.11 from Alexey Sidorov:
   - move variables from .h to .c file (thanks Michael Tokarev for bugreport)
   - fix string comparison (thanks Michael Tokarev for bugreport & Charles Lepple for patch)
   - added BNT-other, for BNT 100-120V models (I havn't specs for it)

Sat Jan 26 04:27:58 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: Starting to add support for protocol 0004. Bumped
   driver revision to 0.13.

Tue Jan 22 04:00:34 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - packaging/debian/rules: The skel driver isn't built if we only build a subset of the
   drivers. Remove it in any case.

Tue Jan 22 03:34:34 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - driver/powercom.[ch], data/driver.list, man/powercom.8: Powercom update from
   Alexey Sidorov.

Tue Jan 22 03:22:11 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - data/driver.list, AUTHORS: update with Oneac information from Jacob Schmier

Mon Jan 21 11:59:42 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libmge-xml:
   - Fix memory leak (dynamically allocated memory would not be free'd
     after an error condition, change to automatic buffers).
   - C90 doesn't allow mixing code and data.

Mon Jan 21 11:42:23 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - server/<various>: Remove the ACL mechanism from the server and by
   default only listen to the localhost (127.0.0.1 and/or [::1] address).

Fri Jan 18 15:26:45 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - mge-xml: add support for MGE* Environment Sensor (ref 66 846).
   This adds the data ambient.temperature and ambient.humidity, and
   is equivalent to the below snmp-ups feature.
   This change affects mge-hid.c but only applies to mge-xml since
   this sensor is a pure Network Management Card addon.

Fri Jan 18 14:03:01 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * snmp-ups:
   - mgemib.h: add support for MGE* Environment Sensor (ref 66 846).
     This adds the data ambient.temperature and ambient.humidity.
   - snmp-ups.c: fix the handling of multiplier on ambient.temperature
     for units other than APC. Bump driver release to 0.43

Tue Jan 15 15:25:10 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Fixed year lag on me and Arnaud in ChangeLog. We where stuck in 2007.
    And some dates. Thanks to Janos Farkas

Tue Jan 15 06:59:00 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Added line in nut-usbups.rules.in for Powerware 3110 5115 and 9120 using
   the old interface.(Also fixed a day problem in ChangeLog)

Mon Jan 14 22:20:44 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: changed default subdriver for Unitek Alpha
   1200Sx to phoenix.

Mon Jan 14 20:49:48 UTC 2008 / Peter Selinger <selinger@users.sourceforge.net>

 - upsdrvctl: pass "-u" flag to the driver also in shutdown mode. Print
   actual command line when debugging.
	
Wed Jan 10 14:37:34 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 * mge-xml: new experimental driver for MGE (Office Protection Systems
   and UPS Systems) Network Management Cards and Proxy.
   This driver use the same HID core as usbhid-ups and newmge-shut
   and its development is sponsored by MGE Office Protection Systems.
   The ezXML parser has been embedded in the source to allow the
   driver development (dual licensed under MIT + GPL).

Sat Jan 12 16:15:00 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Changed <stdint.h> to "nut_stdint.h" in nut_usb.c. Pointed out by Arjen. 

Sat Jan 12 15:44:43 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/hidparser.c: The changes in r1210 broke the calculation of the size
   of reports, so this change is reverted.
 - drivers/libhid.c: Check if the HID Path ends in 0x00000000 and if so, assume
   this variable isn't used and don't update it when we receive an update over
   the interrupt pipeline. Optimized the order in which we determine if a
   variable needs updating so that the most restrictive tests are done first.

Thu Jan 10 16:57:50 UTC 2008 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Added possible fix for Powerware 3110 5115 and 9120 on usb to nut_usb.c
   Changed driver to version to 0.14.

Wed Jan  9 09:32:06 UTC 2008 / Arnaud Quette <aquette.dev@gmail.com>

 - packaging/debian/changelog: update the release version to 2.3.0-1

Tue Jan  8 01:53:09 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - Added info about all recently reported models, supported by
   megatec_usb driver.

Mon Jan  7 03:28:32 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - Patch from Jacob Schmier: drivers/oneac.[ch]: Updated for models ON700XAU,
   ON1000XAU, ON1500XAU.

Sat Jan  5 18:45:26 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite-hid.c: Don't apply battery voltage scaling if this
   isn't needed. Also, add some more variables and flags (so that we
   don't keep on asking for (semi)static data.

Sat Jan  5 11:20:06 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/*-hid.[ch]: Change the parameter passed to the conversion
   functions from (long) to (double) so that we are able to convert
   floating point values without losing precision.

Sat Jan  5 06:37:12 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: add phoenix subdriver to the list. Thanks
   Boris Kleint for pointing this out.

Fri Jan  4 17:46:40 UTC 2008 / Charles Lepple <clepple@gmail.com>

 - drivers/tripplite_usb.c: Rename the "send_Z" command to "reset.input.minmax"

Fri Jan  4 06:56:22 UTC 2008 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: added reconnect support based on the code
   from tripplite_usb driver.

Wed Jan  2 20:17:48 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/hidparser.c: Parsing continues if the HID path for a report
   ends in 0x00000000 (these will not be made available). Commonly used
   as placeholders.

Wed Jan  2 19:59:21 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/libhid.[ch]: In HIDDumpTree() show all reports that are parsed
   from the report descriptor. Remove parameter from HIDGetItemData() and
   HIDGetDataItem() that is never used.
 - drivers/usbhid.c: Implemented the above.

Tue Jan  1 15:31:01 UTC 2008 / Arjen de Korte <arjen@de-korte.org>

 - drivers/usbhid-ups.c: Don't use the data we receive through input
   reports, but retreive it by polling for the feature report (only the
   report number is used to determine which one to get).

Mon Dec 31 16:30:50 GMT 2007 / Charles Lepple <clepple@gmail.com>

 - include/Makefile.am: remove GNU Make extensions from rule to create
   nut_version.h, and handle case where svnversion does not exist.

Mon Dec 31 15:54:23 UTC 2007 / Charles Lepple <clepple@gmail.com>

 - include/Makefile.am: fix failure to build after "make clean", since
   nut_stdint.h is built by configure, not make.

Sat Dec 30 12:16:12 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 - drivers/megatec.c: qualify nominal values and frequency as "input" again.

Sat Dec 29 20:16:37 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 - drivers/megatec.c: detect OB status while OFF.

Sat Dec 29 16:40:45 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 * drivers/megatec.c:
   - Better handling of unsupported commands (load.off and shutdown.stayoff
     now do the right thing -- indefinite power off -- when possible.
   - Battery test sets CAL instead of OB.
   - Report ups.type as "online" or "standby".

Sat Dec 29 10:39:51 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - docs/new-drivers.txt: If UPS alarms are used, the call to alarm_commit()
   should precede the call to status_commit(), otherwise the ALARM flag
   will be delayed.
 - drivers/megatec.c: Applied the above.

Fri Dec 28 21:58:32 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 * drivers/megatec.c:
   - Detect LOAD_OFF weirdness on startup.
   - Limit "load.off" and "shutdown.stayoff" to 9999 minutes because 0000
     makes the load power-on immediately if line power is available and the
     command form without a restore timer isn't supported by all models.
   - Set an alarm instead of changing status on FAILED.
   - Make OFF status independent of OB/OL.

Fri Dec 28 14:58:12 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 - drivers/megatec.c: Added option to ignore the LOAD_OFF flag.

Thu Dec 27 06:37:50 UTC 2007 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Added myself into tha AUTHORS file.

Sun Dec 16 19:53:51 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - conf/upsstats-single.html.sample, conf/upsstats.html.sample:
   The snmp driver reports 3-phase variables which APC's claims to
   support but returns junk for. Doing IFSUPP against the L2
   variables rather than the L1 ones. [George Ross]

Wed Dec 12 20:29:51 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/apcsmart.[ch]: Add support for older Smart-UPS devices.

Wed Dec 12 20:22:39 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/usbhid-ups.c: Don't attempt to reconnect after receiving
   an unexpected error message, but instead just log a message and
   continue (this is in line with earlier behaviour).

Wed Dec 12 20:18:35 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 = drivers/tripplite-hid.c: Apparently, the OMNI1000LCD has the same
   bug as the AVR 550U, so 'UPS.PowerSummary.iDeviceChemistry' should
   not be used either. Swapped 'UPS.PowerConverter.Output.Voltage' and
   'UPS.PowerSummary.Voltage' since the latter seems to be broken on
   the OMNI1000LCD.

Tue Dec 11 20:41:13 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite-hid.c: Add support for watchdog (undocumented
   feature for now).

Tue Dec 11 20:11:02 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - <various>: Include "nut_stdint.h" where needed (and don't include it
   when not needed).

Sat Dec  8 19:28:03 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/bestfcom.c: Delay values in ser_get_* functions probably used
   milliseconds instead of microseconds. Driver now also shows power
   values from the UPS.

Thu Dec  6 19:46:54 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplite-hid.c: Workaround for firmware bug in the AVR 550U
   where reading 'UPS.PowerSummary.iDeviceChemistry' string would crash
   the UPS.

Mon Dec  3 19:33:52 UTC 2007 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: added reopen matcher for future reconnect
   support (should be soon if I have time :) ).

Mon Dec  3 00:55:25 UTC 2007 / Charles Lepple <clepple@gmail.com>

 - include/Makefile.am: clean up autogenerated nut_stdint.h (fixes "make
   distcheck")

Sun Dec  2 20:19:34 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - configure.in, m4/ax_create_stdint_h.m4: Added the AX_CREATE_STDINT_H
   macro to create our own header file with fixed width types.
 - <various>: Use above mentioned header file, instead of <stdint.h>.

Mon Nov 26 19:46:21 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 * drivers/megatec.c:
   - get the values for the "ondelay" and "offdelay" parameters in
     upsdrv_shutdown(), otherwise the defaults are used leaving
     users confused.
   - rewrite documentation for "ondelay" since this timer starts
     counting the moment the UPS is turned off, and not the
     moment line power is restored.
   - Remove "ups.delay.start" and "ups.delay.shutdown" variables
     since they would only affect instant commands and are thus more
     cunfusing than useful in the real world.
   - Changed the check_ups() function to reuse the run_query() function
     instead of duplicating code.
   - Changed the detection process to keep the UPS status for later
     use instead of having to query the UPS again (if this were to fail,
     the driver would fatalx() leaving users confused).

Mon Nov 26 18:27:52 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec_usb.c: Allow longer commands in the 'phoenix'
   subdriver.

Mon Nov 26 14:01:56 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec_usb.c: Echo back the unsupported 'I\r' and 'C\r'
   commands in the 'phoenix' subdriver.

Mon Nov 26 13:45:06 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplitesu.c: Fixed copy-paste error in this driver that
   dates back from the conversion to the new serial I/O functions a
   couple of years back.

Mon Nov 26 10:02:26 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplitesu.c: Read the response per byte, so that where
   a timeout occurs.

Mon Nov 26 08:58:25 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec_usb.c: Add new 'phoenix' subdriver, since it seems
   to drift away from what is needed by the 'agiler' subdriver.

Sun Nov 25 19:48:22 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/tripplitesu.c: Add debugging code to help diagnose driver
   problems.

Sun Nov 25 18:59:33 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec.c: Fix counting detection attempts. Don't flush
   input- and output buffers before sending any command (too verbose
   for the USB subdrivers).
 - drivers/megatec_usb.c: Padding to 8 characters for commands send
   through set_data_agiler(). Apparently, some devices need that.

Sun Nov 25 11:44:58 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec.c: Limit detection of UPS to minimum required number
   of successful attempts. Flush input- and output buffers before sending
   any command.

Sun Nov 25 10:53:38 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec_usb.c, scripts/hal/20-ups-nut-device.fdi: Added
   Mustek Powermust as supported through 'megatec_usb' driver.

Mon Nov  5 20:21:45 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/nitram.c: Added experimental flag to this driver because it
   lacks support to shutdown the UPS.

Sun Nov  4 20:08:53 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/hidparser.c: Fix non-portable type conversions.

Fri Nov  2 06:48:57 UTC 2007 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: merged all functionality of get_data_krauler
   to set_data_krauler thus removing most sources of code duplication
   in krauler subdriver.

Thu Oct 18 17:51:07 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - data/drivers.list: add Belkin F6H375-USB compatibility through
   megatec_usb (depending on vendorid)

Mon Oct 15 11:14:06 UTC 2007 / Arnaud Quette <aquette.dev@gmail.com>

 - data/drivers.list: add Powerware 9110 compatibility through upscode2

Mon Oct 15 08:12:28 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - scripts/udev/nut-usbups.rules.in: Make udev rules compatible with
   newer kernels compiled without CONFIG_USB_DEVICE_CLASS.

Tue Oct  9 22:54:08 UTC 2007 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 * drivers/megatec_usb.c:
   - moved the code from subdriver init function which actually does
     flushing buffers to ser_flush_io().
   - added subdriver 'flags' to export information about subdriver.

Wed Oct  3 00:01:09 UTC 2007 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: added ability to do subdriver-specific
   initialization, and moved some shared code to agiler init function
   since krauler doesn't need it.

Mon Oct  1 07:49:31 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/snmp-ups.c:
   - Allow passing a value to an instcmd.
   - Be less verbose to the syslog when output is needed for debugging
     purposes only.

Fri Sep 28 18:37:05 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/upshandler.h,dstate.h,dstate-hal.h: The return values for
   the setvar() and instcmd() handlers are now an enum value, to add
   return values easily.

Fri Sep 28 17:18:57 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - Added entry for Liebert PowerSure Personal XT in HAL script.
 - Moved 'include/upshandler.h' to 'drivers/upshandler.h' since this is
   only used in the drivers.

Wed Sep 26 20:51:20 UTC 2007 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Changed the 'ups.voltage.nominal' to 'output.voltage.nominal' in bcmxcp driver.

Tue Sep 25 20:51:47 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/cps-hid.c: Change 'CPS' to 'CyberPower' in some locations.
 - drivers/libshut.c,libusb.c: Fix compiler warnings.
 - drivers/usbhid-ups.c: Map ShutdownImminent back to LB.

Tue Sep 25 18:45:10 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/usbhid-ups.c: Clean up after ourselves.

Tue Sep 25 18:33:49 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/ietfmib.h: (Bernd Markgraf)
   - addition of battery temperature
   - addition of input.quality via UPS-MIB::upsInputLineBads values
     >0 showing line failures
   - correct OID to query number of input phases (now ietf reports
     3 phases on my bunch correctly)
   - corrected OID to query output current
   - corrected multiplier for output.realpower (reported in Watts, so 1)

Mon Sep 24 18:01:56 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - conf/upsmon.conf.sample: List the default values for NOTIFYMSG
   and NOTIFYFLAG. [Alioth Feature Requests #302016]

Sun Sep 23 18:34:20 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/cps-hid.c: Add server side variables.
 - scripts/subdriver/path-to-subdriver.sh: Add server side variables,
   sort the HID paths alphabetically and remove duplicates.

Sat Sep 22 19:22:56 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/cps-hid.[ch]: Created a new subdriver for CyberPower HID
   UPS systems.
 - drivers/Makefile.am,usbhid-ups.c: Added new CyberPower subdriver.
 - drivers/apc-hid.c: Removed CyberPower from this subdriver.
 - scripts/subdriver/path-to-subdriver.sh: Some minor corrections to
   make the output compliant to what we expect.

Sat Sep 22 17:59:56 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/megatec_usb.c: Packetizing is already done by the libusb
   library, so we don't need to duplicate that.

Sat Sep 22 07:14:39 UTC 2007 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 * drivers/megatec_usb.c: merged Arjen de Korte's changes in krauler
   subdriver with slight modifications:
   - commands are now stored in a table, making it simplier to process
     them
   - switched to libusb.c API completely

Mon Sep 17 19:09:47 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - data/cmdvartab, docs/new-names.txt: Removed "shutdown.restart".
 * drivers/usbhid-ups.c:
   - Corrected shutdown function (should fallback to 'shutdown.reboot',
     not 'shutdown.return').
   - Renamed 'shutdown.restart' to 'shutdown.return', which almost has
     the same meaning, with the exception that it doesn't shutdown the
     UPS.
 * drivers/<usbhid-ups subdrivers>:
   - Implemented the above.

Mon Sep 17 11:33:17 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - clients/upscmd.c: Allow passing an additional parameter in a command.
 - drivers/dstate.c: It is now possible to pass a parameter to instcmd(),
   for instance a delay value.
 - scripts/subdriver/path-to-subdriver.sh: Implemented the above.
 * drivers/usbhid-ups.[ch]:
   - Implemented the above. If no parameter is passed, the default from
     the HID-to-NUT mapping is used (as was the case previously).
   - The main driver now takes care of shutting down the UPS through
     instcmd's that are configurable in the subdrivers. This makes sure
     that the behaviour is consistent among subdrivers and meets the
     expectations of the NUT shutdown/restart mechanism.
   - DEFAULT_ONDELAY and DEFAULT_OFFDELAY are now much shorter. If an
     application needs a grace period before shutting down the UPS, it
     this should be put 'ups.conf', rather than to make this the
     default (even for configurations where this is not needed at all).
 * drivers/<usbhid-ups subdrivers>:
   - Implemented the above. Added "shutdown.restart", "shutdown.stayoff"
     and "shutdown.return" instcmd, which feed the shutdown function in
     the main driver.
   - Removed HU_FLAG_OK and cleaned up mapping tables.
   - Some subdrivers would make 'ups.delay.start/reboot/shutdown'
     writeable. This is an error, since by doing so, it becomes an
     instcmd (and should be listed as such). The same goes for
     'ups.beeper.status'.

Sat Sep 15 19:58:40 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/snmp.c, man/snmp-ups.8: The lack of a shutdown function is
   not an issue. This won't work, since at the time when we would run
   'upsdrvctl shutdown' (near the end of the system halt script), in
   all likelyhood we won't have network capabilities anymore.

Sat Sep 15 18:54:40 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/usbhid-ups.c: Initialize data from UPS in upsdrv_initups().
   We may be shutting down, so the HID-to-NUT variable mapping needs to
   be in place.

Wed Sep 12 22:17:01 UTC 2007 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 - drivers/megatec_usb.c: added debug dumping in both subdrivers.

Wed Sep 12 22:12:53 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 * drivers/megatec.c:
   - One more entry in the "batteries" array.
   - Nominal battery value is now a float (some models need this).
 * data/driver.list:
   - Two more models supported by megatec.

Tue Sep 11 14:21:17 UTC 2007 / Arnaud Quette <aquette.dev@gmail.com>

 - clients/upsclient.h: add a typedef UPSCONN on UPSCONN_t since
   the renaming of the former broke the external client application
   compatibility. This is only temporary, and client applications
   will have to adapt their code, using pkg-config / libupclient-config
   and some #defines.
 - UPGRADING: add a (doubled for both 2.2.0 and 2.2.1) message to warn
   client applications developers of the above change.

Tue Sep 11 12:47:10 UTC 2007 / Arnaud Quette <aquette.dev@gmail.com>

 - data/driver.list: Added MGE Office Protection Systems compatibility
   information.

Mon Sep 10 11:36:16 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.c:
   - The driver will now reconnect when it finds that another program
     has claimed the USB device it uses.
   - Cleaned up indentation.
   - Changed the way how 'input.transfer.reason' is treated.
 * drivers/mge-hid.c,tripplite-hid.c:
   - Changed 'input.transfer.reason'.

Sun Sep  9 19:14:46 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/belkin-hid.[ch]: Version should not be defined in .h
   file to prevent needless rebuilds of the usbhid-ups.o (it was
   duplicated in both and I removed the wrong instance).
 - drivers/libhid.[ch]: The hidparser.h file should not be included
   in the header file.
 - drivers/libshut.c: Don't allocate space for the report descriptor
   dynamically. We already know the maximum size and don't need it
   anymore after leaving the open function.
 - drivers/libusb.c: Same as above.
 - drivers/tripplite_usb.c: Fix potential segfault.
 - drivers/usbhid-ups.c: The 'explore' subdriver should be the first
   in the list of subdrivers.

Sat Sep  8 20:46:25 UTC 2007 / Peter Selinger <selinger@users.sourceforge.net>

 - changed the default installation directory for pkg-config files,
   following a suggestion of Stanislav Brabec. The new default
   location is ${libdir}/pkgconfig. This is still configurable via
   the --with-pkgconfig-dir=PATH option and can be turned off with
   --without-pkgconfig-dir.

Sat Sep  8 10:53:02 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/libhid.c: Remove the remains of what once was an attempt
   to split the HIDDumpTree (I can't rembember why I wanted this in
   the first place).

Sat Sep  8 10:46:32 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.[ch],Makefile.am:
   - Add option 'matching = checksum' that in addition to the
     'normal' matching, will also compare the SHA-1 checkum of the
     report descriptor with the one that was read on startup.

Fri Sep  7 11:51:22 UTC 2007 / Arnaud Quette <aquette.dev@gmail.com>

 - fixes the NUT versioning on exported SVN trees, due to i18n
   translation of the "exported" keyword. This resulted in
   <nut version>- instead of <nut version> only, without the "-"

Wed Sep  5 19:02:51 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.c: Timelimitexpired should be mapped to LB
   as well, as it is also an indication that the battery is low
   (instead of looking at remaining charge, it looks at remaining
   runtime left).

Tue Sep  4 19:10:19 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/belkin-hid.c: That was sloppy... :-(

Tue Sep  4 18:11:26 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/belkin-hid.c: Fallback to UPS.PowerSummary.iSerialNumber
   if (usb_device *)descriptor.iSerialNumber is empty. Together
   with 'matching = delayed' this allows to match on serial number
   for these devices as well.

Mon Sep  3 18:46:04 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - data/driver.list: Added Jasuny USPS from Jageson Technology to
   the list of supported UPS'es (genericups upstype=4).

Mon Sep  3 07:05:33 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.[ch]: Changed the 'reconnect' option to
   'matching'. Behaviour is slightly different.

Mon Sep  3 06:45:59 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libusb.c: Remove unused variable and structure.

Sun Sep  2 18:39:39 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.[ch]:
   - Add 'possibly_supported' helper function that can be called
     from subdrivers with the vendor name and HIDDevice_t data and
     displays an informative message that a device might be
     supported.
     Doing this in one location guarantees consistent behaviour.
 * drivers/<hidsubdrivers>:
   - Implemented above change.

 Added Tripplite 09ae:2007 (OMNI900LCD) to supported devices.

Fri Aug 31 15:48:56 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/hidparser.c:
   - Fix realloc'ing memory. Resize array to the number of reports
     we have parsed, rather than the size it already had (duh!)
 * drivers/libusb.c:
   - Fix regex_matcher which was broken by r1073.
   - Fix (harmless) memory leaks if a regular expression can't be
     compiled (the driver terminates anyway).

Thu Aug 30 19:31:41 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.[ch]:
   - Added new setting 'reconnect' that determines behaviour how
     the driver will try to reconnect to the UPS. Documentation
     will be updated as soon as enough developers have given their
     opinion on this.

Thu Aug 30 18:59:15 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/hidparser.c:
   - Instead of using malloc() / automatic variables and clearing
     the contents before use with memset, use calloc right away.
   - Allocate pDesc->item in one chunk and realloc it when we know
     how many reports we have once, instead of realloc'ing it one
     item at a time.
   - Removed redundant copy of ReportDesc (is not modified, so we
     can use that).
 * drivers/belkin-hid.[ch]:
   - BELKIN_HID_VERSION was defined twice.

Thu Aug 30 06:59:50 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/hidparser.c:
   - Dirty way of clearing replen (which happens to be an int, not
     a char) leaves uninitialised values.

Tue Aug 28 20:46:34 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/belkin-hid.c:
   - Fix memory leak in belkin_format_serial()
 * drivers/apc-hid.c:
   - A call to apc_format_model() could change the contents of the
     hd->Product string. This is undesireable.
 * drivers/mge-hid.c:
   - Cleaned up mge_format_model().
 * drivers/usbhid-ups.c:
   - The vendor-specific method for calculating human-readable
     strings for manufacturer, model, and serial are back in
     upsdrv_initinfo to make sure the above problems don't lead
     to problems in the future.

Mon Aug 27 18:33:37 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid.c:
   - Mental note: "close all source files *before* comitting, to
     prevent the one character that you modified from missing the
     commit."

Mon Aug 27 18:23:06 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch],libshut.[ch],libusb.[ch]:
   - Cut the libshut and libusb objects loose from libhid. If no HID
     functions are used (megatec_usb, tripplite_usb), you no longer
     need to include libhid anymore. The USB matcher functions (which
     were not really HID specific functions) are now within libusb.
 * drivers/megatec_usb.c,tripplite_usb.c,Makefile.am:
   - Applied the change above.
 * drivers/usbhid.[ch]:
   - The HIDOpenDevice() and HIDCloseDevice() functions no longer
     exist. These are replaced by direct calls to the communication
     subdrivers.
   - The driver now gets a callback from libshut_open() and
     libusb_open() when a report descriptor has been retrieved from
     the USB/SHUT device and parses it and then makes a descision
     on whether this device is acceptable or not. If not, the next
     device that matches will be tried.

Sun Aug 26 09:20:45 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch],libshut.c,libusb.c:
   - Added a callback function in the libshut_open and libusb_open
     that is called after the report descriptor is read, but before
     the device is accepted.
 * drivers/megatec.c:
   - Applied change above.

Fri Aug 24 20:02:35 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.c:
   - The behaviour of reconnect is now depending on the
     'reloadmatcher' variable. By default, it uses 'exact' matches,
     but this can be changed to 'regex', which means that it will
     use MODE_OPEN instead of MODE_REOPEN. Essentially, it will
     behave exactly like starting again.
 * drivers/libusb.c,libshut.c:
   - The decision whether or not it is safe to close the connection
     to the device before opening a new one is now made in the
     libusb_open() and libshut_open() functions.
   - Fixed small memory leak in libusb_open().
 * drivers/libhid.c:
   - The 'exact' matcher now also matches the Bus too (this won't
     change as long as the USB plug is not removed). If you don't
     like this, use the 'regex' matcher instead.
 * drivers/megatec_usb.c,tripplite_usb.c:
   - The 'mode' parameter is now passed by value again, instead of
     by reference from r1073 (this wasn't a good idea after all).

Thu Aug 23 19:30:28 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch],libshut.c,libusb.c:
   - The 'mode' variable for HIDOpenDevice is now passed as pointer.
     If a device can't be re-opened (because we can't get an exact
     match), this will be modified to MODE_OPEN and treated as such.
   - Cleaned up matcher functions.
 * drivers/usbhid-ups.[ch]:
   - When re-connecting to a device, re-read all variables and
     commands from it. If it turns out that we couldn't re-open it
     (for the reasons mentioned above) we will treat it as a new
     device and will flush everything (except "ups.status") and
     start all over again.
 * drivers/dstate-hal.c,megatec_usb.c,tripplite_usb.c:
   - Align with the above.

Wed Aug 22 18:12:50 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch]:
   - Allocate storage for report buffer when creating it. Only free
     it when we're done with it. This makes sure we don't run into
     memory allocation errors after startup.
   - Allow passing a timeout value on HIDGetDataValue().
   - HIDOpenDevice() will now handle closing the device on reload if
     needed, so that HIDCloseDevice() can now really close it and
     free the allocated memory for report buffer and parsed report
     descriptor.
   - Removed dynamic allocation of HID events, instead we now pass a
     pointer to an array of HIDData_t pointers.
 * drivers/usbhid.c:
   - We now try to get all events in one pass of upsdrv_updateinfo(),
     instead of just one report.
 * drivers/libshut.c,libusb.c:
   - There is no need to sleep for a while, if the communication
     subdriver doesn't support interrupt transfers.

Tue Aug 21 20:29:25 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/pwmib.h:
   - Use IETF_OID_BATT_STATUS for battery status (previous change
     from r1064) didn't work correctly.
   - Added 'vendor.specific.abmstatus', which violates the NUT
     standards, but for now this is all I could come up with.

Tue Aug 21 18:59:03 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.c:
   - The HIDGetEvents() function used a timeout value of 5000ms.
     Since the underlying libusb function uses synchronous I/O (at
     least for version 0.1), this means that it blocks on this when
     no interrupt report is available. Lowered timeout to 250ms, as
     it is better to retry on the next call, than to hang around
     waiting for an interrupt report. Improves responsiveness.
 * drivers/usbhid-ups.[ch]:
   - Moved 'pollfreq' and HIDDumpTree() from upsdrv_initups() to
     upsdrv_initinfo(). These are not needed when we run the shutdown
     command, so they should not be in upsdrv_initups().
   - Removed checking of the exit_flag. We don't spend a lot of time
     in these loops, so it's not worth checking it.
   - Added 'interval' helper function, that returns the time since
     the last time it was called. Will only be compiled in if DEBUG
     is defined.
   - The 'udev' global variable (needed by mge-hid) is a pointer to
     hid_dev_handle_t.
 * drivers/tripplite-hid.c:
   - Updated comment about changing 'udev' and 'hotplug' rules.

Tue Aug 21 18:42:11 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/*-hid.c,libhid.[ch],libshut.c,libusb.c,usbhid-ups.c:
   - HIDGetItemString() would return a NULL pointer if index value
     was not found, which was not how it was used. Now clears the
     buffer and always returns pointer to buffer.
   - Pass length of buffer in calls to HIDGetItemString() and
     HIDGetIndexString() to prevent risking buffer overflow. The
     underlying calls would limit the length to 20 bytes, but this
     would not prevent overflow if a smaller buffer was allocated.
   - Use snprintf() instead of sprintf().

Tue Aug 21 06:35:45 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.c, drivers/usbhid-ups.c:
   - Moved the 'cast' from an Input report to a Feature report to
     usbhid-ups.c.

Mon Aug 20 19:58:42 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/mge-hid.c:
   - Added HU_FLAG_SEMI_STATIC for several user changeable variables
     where applicable.

Mon Aug 20 19:44:04 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch]:
   - We cache the pointer to the Feature report that corresponds with
     a NUT variable, but what we receive on the interrupt pipeline is
     an Input report (apple != pear). So find_hid_info() would never
     find a match, since it only looks to the Feature reports. Need
     to find a better way to do this, but it works for now.
   - Added HIDDataType() helper function, to display the report type.
 * drivers/usbhid-ups.c:
   - Added some debugging lines, so that we know where we are.

Mon Aug 20 14:12:47 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.c:
   - Return from the HIDDumpTree() immediately, if nut_debug_level
     is too low. Otherwise, even if nothing will be printed, it
     will proceed to query everything from the report descriptor.
     This will take a long time on my Evolution 650, since the
     queries for 'UPS.COPIBridge' timeout, without ever yielding
     something useful.

Mon Aug 20 12:35:24 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 This update is based on input from Bernd Markgraf.

 * drivers/ietfmib.h:
   - Added 'test.battery.start.quick' and 'test.battery.start.deep'
     instcmd.
 * drivers/pwmib.h:
   - Added 'shutdown.stop', 'load.on' and 'load.off' instcmd.
   - Use PW_OID_BATT_STATUS, PW_OID_ALARM_OB and PW_OID_ALARM_LB
     instead of IETF_OID_BATT_STATUS.

Mon Aug 20 11:32:42 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch], drivers/usbhid-ups.c:
   - Pass events as pointers to HIDData_t elements, instead of strings.
     All HID paths that we handle will be cached by these, so we only
     have to deal with events that we don't know of yet (which won't
     happen that often) and which we can't use anyway (needs an entry
     in hid_info_t table).
   - Values which are received through the interrupt pipeline were
     passed as logical instead of physical data. Corrected by getting
     the values from HIDGetDataValue().
   - Fixed some typo's from earlier patches.

Mon Aug 20 08:14:38 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.[ch]:
   - Only parse the HID pathname to a HIDData_t pointer once, during
     HU_WALKMODE_INIT, instead of each time we read/write a value
     from/to the report buffer.

Mon Aug 20 07:48:46 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch]:
   - New functions HIDGetDataValue() and HIDSetDataValue() that are
     similar to the existing HIDGetItemValue() and HIDSetItemValue(),
     but take a pointer to a HIDData_t, instead of a HID pathname
     (text string).
   - Don't read back the value after changing it. We can't do anything
     with that value, even if it is different from what we set (the
     device may have corrected an out-of-range value). If you need this,
     call HIDGet(Item|Data)Value function instead afterwards.
   - Add HIDGetIndexString() function to read string by index.
   - Use upsdebug_with_errno() instead of upsdebugx() where appropriate.
   - Show when we get something from the report buffer 'Report[b]' or
     set a value 'Report[s]' in debug mode.

Mon Aug 20 07:20:02 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/mge-hid.c:
   - Logical error, 'equal to one' is not the same as 'not equal to
     zero'. The first indicates HIDGetItemValue read a value, while
     the latter also includes the cases where no data could be read
     because the device was disconnected.

Sat Aug 18 18:47:02 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.c:
   - Fix compilation problem. 

Thu Aug 16 19:03:49 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch]:
   - Changed 'float' to 'double', to prevent loss of precision when
     long values are casted to floats and back to long again.
   - Rewrote some helper functions (string_to_path, path_to_string,
     hid_lookup_usage, hid_lookup_path).
   - The path_to_string function can no longer overflow the buffer
     (we were dangerously close to the 64 character limit already).
 * drivers/usbhid-ups.c:
   - Changed 'float' to 'double' (see above).
 * drivers/belkin-hid.c, drivers/mge-hid.c:
   - Changed 'float' to 'double' (see above).
   - HIDGetItemString is passed a (char *) buffer since r1055, not
     a (unsigned char *).
 * drivers/*-hid.c:
   - Usage lookup tables is now terminated with { NULL, 0 } instead
     of { "\0", 0x0 }.

Wed Aug 15 21:47:12 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/pwmib.h:
   - Battery runtime is in seconds, not minutes.
   - The update of the snmp-ups driver is based on input from
     Bernd Markgraf (forgot to mention that in previous update).

Wed Aug 15 20:21:49 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/snmp-ups.c, drivers/ietfmib.h, drivers/pwmib.h:
   - Use all "ups.status" lines, not just the first.
   - Add a lot or parameters for PowerWare and some for IETF.

Wed Aug 15 19:37:41 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/libhid.[ch]:
   - Flush report buffer after writing new values to the UPS. The
     data in the UPS may change because of this, so we want to be
     sure that all subsequent reads, return fresh data.
   - Use calloc() instead of malloc() where useful.
   - HIDGetItemString returns (char *) but receives a (unsigned
     char *) as parameter.
   - physical_to_logical() would always return an integer, since it
     casts the result of the value conversion to a long, before
     returning the result as float.

Wed Aug 15 19:11:40 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/upshid-ups.[ch]:
   - Move the point where we cast the (float) output from what we
     have received through HIDGetItemValue() to a (long) index
     value for the lookup tables to the hu_find_infoval() helper
     function. By doing so, it should be relatively easy to allow
     conversion functions to use the float value, rather than the
     long they have now (might be useful for converting small
     values).

Tue Aug 14 18:47:10 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/snmp-ups.c:
   - Missing curly brackets.

Tue Aug 14 18:31:12 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.c:
   - Helper function 'find_nut_info_valid' removed. We check for the
     validity of commands and variables during the initialisation, so
     this doesn't need to be repeated when we run instcmd() or
     setvar(), so they can both use 'find_nut_info'.

Mon Aug 13 21:35:13 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/mge-hid.c:
   - Variables that can be changed need to have 'HU_FLAG_SEMI_STATIC'.

Mon Aug 13 19:53:12 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * data/cmdvartab, docs/new-names.txt, docs/hid-subdrivers.txt:
   - Rename 'beeper.on' -> 'beeper.enable'
   - Rename 'beeper.off' -> 'beeper.disable'
   - Added 'beeper.mute'
 * drivers/*-hid.c:
   - Added the 'beeper.disable' command to all subdrivers, this may not
     work on al UPSes (it is described in the HID Power Devices document).
 * drivers/<various>:
   - Updated drivers with new names for 'beeper.{enable,disable,mute}'
     commands.
   - Applied a mapping from old to new commands, in order not to break
     existing installations. Mapped 'beeper.on' to 'beeper.enable' and
     'beeper.off' to 'beeper.disable' or 'beeper.mute', depending on
     the comments in the driver.
 * man/<various>:
   - Updated the man pages for drivers that described these commands.

Mon Aug 13 13:08:13 UTC 2007 / Alexander I. Gordeev <lasaine@lvk.cs.msu.su>

 * drivers/megatec_usb.c: added credits to the banner message.

Mon Aug 13 09:28:42 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * data/cmdvartab, docs/new-names.txt:
   - Added a couple of variables that are used in MGE devices.
 * drivers/mge-hid.c:
   - Added 'input.voltage.extended' and 'input.frequency.extended'
     variables, that can be used to extend the input voltage and
     -frequency ranges that can be set.

Sun Aug 12 19:03:55 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/dstate-hal.c:
   - Added dummy dstate_delinfo() function to keep the buildbot happy.

Sun Aug 12 18:54:22 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid-ups.c:
   - Modifying the comment in the header of a function doesn't change the
     returncodes of it. Too bad I assumed that the comment was correct.

Sun Aug 12 18:37:00 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/*-hid.c, drivers/usbhid-ups.[ch]:
   - Added HU_FLAG_QUICK_POLL flag on all hid_info_t that deal with the
     'online', 'chrg', 'dischrg' and 'lowbatt' internal flags so that the
     HU_WALKMODE_QUICK_UPDATE is actually doing something useful.
   - Unconditionally do a HU_WALKMODE_QUICK_UPDATE if we're not running a
     HU_WALKMODE_FULL_UPDATE. With the above, this means that all but the
     MGE subdriver will do more polls to the UPS, so this needs to be
     verified.
   - Changed NUT variable name from "ups.status" to "BOOL" for hid_info_t
     elements that would only set/clear an internal status flag. This in
     order to prevent confusion by developers, since these elements can
     deal with both "ups.alarm" and "ups.status".
   - Separated setting "ups.status" and "ups.alarm". The first will be
     done each time upsdrv_updateinfo() runs, while the latter will only
     be processed when doing a full update. This makes it possible that
     subdrivers set vendor specific alarms, without having to change
     usbhid-ups at all.
   - Don't set CHRG when the internal flag 'fullycharged' is set and don't
     set DISCHARGE when the internal flag 'depleted' is set.
 * drivers/apc-hid.c:
   - Changed "ups.power.nominal" to "ups.realpower.nominal", which is the
     correct NUT parameter for CyberPower.
 * drivers/mge-hid.c:
   - Added an example for a vendor specific alarm (emergency stop).
 * drivers/dstate.c:
   - Prepend the ALARM status (if applicable) in status_commit() instead
     of in status_init().

Sun Aug 12 02:34:19 UTC 2007 / Peter Selinger <selinger@users.sourceforge.net>

 * drivers/tripplite_usb.c: removed an unused variable
 * drivers/usbhid-ups.c: fixed a potential segfault
	
Sat Aug 11 19:03:15 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * docs/new-drivers.txt:
   - Added the CHRG and DISCHRG status to the list of recognized status
     words.
   - Made a note that OL and OB specifically deal with input status.
 * drivers/usbhid-ups.[ch]:
   - Changed the 'ups.status' signals not defined in the above document
     into 'ups.alarm' (where appropriate).
   - Added 'input.transfer.reason' logic to merge 'voltage out of range'
     and 'frequency out of range' into one message (through 'vrange_info'
     and 'frange_info'. It also takes care of removing this when no
     longer applicable.
   - 'shutdownimm' and 'timelimitexp' no longer map to the LB status
     (this was never a good idea, you need OB LB to have an effect).
   - Added a whole bunch of other status bits, see the ChangeLog.
 * drivers/apc-hid.c:
   - Status 'timelimitexp' is now standard (mapped to an alarm).
   - The 'batterypres' status is now reversed as 'nobattery' (so that
     systems not supporting this, won't show alarms).
   - Commented out the 'fullycharged' status. If anyone can explain the
     use of this, please step forward.
 * drivers/liebert-hid.c:
   - The HID Path 'unmapped.ups.powersummary.idevicechemistry' probably
     needs a stringid_conversion and then maps to the 'battery.type'
     (added as a comment, volunteers needed).
 * drivers/mge-hid.c:
   - 'battery.capacity' and 'input.transfer.reason' added.
   - Added plenty of status bits, see the ChangeLog.
 * drivers/tripplite-hid.c:
   - Commented out the 'fullycharged' status. If anyone can explain the
     use of this, please step forward.
   - Voltage out of range is now mapped to the 'input.transfer.reason'.

Fri Aug 10 22:10:01 UTC 2007 / Arnaud Quette <aquette.dev@gmail.com>

 * scripts/hal/20-ups-nut-device.fdi: add missing entries

Fri Aug 10 20:05:11 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/usbhid.[ch]:
   - Moved the struct & data for ups.status processing to usbhid.c, since
     this is only used in there. Subdrivers report the status through
     text messages, they don't set the status bits directly.
   - Rewrote (flattened) the upsdrv_updateinfo() and hid_ups_walk() functions,
     so that it is easier to follow/understand what is happening. Also limit
     the amount of status update to once every upsdrv_updateinfo and not for
     each status report we get. This is enough, since we don't handle requests
     from clients when we're talking/listening to the UPS.
   - If the UPS sends reports on the interrupt pipeline, we consider that
     enough proof that it is still there. At the same time, we assume that it
     keeps us informed of *all* important status changes, so that doing a
     HU_WALKMODE_QUICK_UPDATE is redundant then.
   - Added a ups_infoval_set() function that is doing the actual setting of
     values we got from the UPS. This is convenient, so that if we change
     something in the way we deal with those, it is all in one location.

Fri Aug 10 19:02:37 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * data/cmdvartab, drivers/mge-hid.c, drivers/powerpanel.h, man/powerpanel.8:
   - Renamed variable 'ups.coldstart' to 'ups.start.battery'.
 * data/cmdvartab, drivers/mge-hid.c: 
  - Added variables 'battery.protection', 'battery.energysave',
    'ups.start.auto' and 'ups.start.reboot'.
  - Added instcmd decription for outlet.{1,2}.load.on and outlet.{1,2}.load.off
 * drivers/<various>:
  - Use snprintf instead of sprintf where possible.
  - Change termination of info_lkp_t items from "NULL" (= string) to NULL
    (= pointer).

Wed Aug  8 21:35:59 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/dstate.c:
   - Removed stuff to prepend ALARM to 'ups.status', which wasn't
     really useful (see below). Now it no longer complains that
     'ups.status' parameter is not set when calling alarm_commit().
 * drivers/bcmxcp.c, drivers/gamatronic.c:
   - Call alarm_commit() when we're done with setting alarms. There
     is no need to wait for status_commit(). The status_init()
     function will take care of prepending ALARM, as long as we
     call it after alarm_commit().

Wed Aug  8 20:15:45 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/upscode2.c: Removed alarm_init() and alarm_commit(). You can
   only put something useful in the alarm buffer through alarm_set(), so
   if you don't call that, these are not needed either.

Mon Aug  6 14:15:53 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/mge-hid.c:
   - add 'input.sensitivity' and 'ups.coldstart' (R/W)
   - allow to change 'output.voltage.nominal' and 'ups.load.high'
   - add 'output.powerfactor'
   - removed decimals from transfer voltages (makes no sense to specify
     these with that kind of precision)
   - cleaned up some functions (indentation, use of sprintf iso snprintf,
     flow, etc)

Fri Aug  3 12:31:20 UTC 2007 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Changed Driver version to 0.13 and fixed bug in upsdrv_shutdown. Did not read
   the shutdown delay from the config file. So the delay become zero.

Wed Aug  1 19:24:25 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/mge-hid.c: fix 'battery.voltage.nominal' for Evolution 650
   and remove decimals from '*.nominal' values

Wed Aug  1 19:20:33 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/belkin-hid.c, drivers/usbhid-ups.c: workaround for
   incorrect report over the interrupt pipeline that caused spurious
   low battery warnings

Tue Jul 31 19:41:24 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/apcsmart.[ch]: add support for old APC SmartUPS 1250 (the
   changes are small, so I don't see a reason why not to include it)

http://lists.alioth.debian.org/pipermail/nut-upsdev/2007-July/002345.html

Tue Jul 31 18:46:33 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - drivers/mge-hid.c: reformatted 'mge_hid2nut[]' table to always break
   at the same place (which is easier on my eyes)

Tue Jul 31 18:21:56 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 * drivers/mge-hid.c:
   - fixed broken 'output.voltage.nominal' which was actually indicating the
     nominal 'battery.voltage.nominal' (at least on the Evolution 650 and
     Pulsar M 2200 and most likely others too)
   - the above parameter is broken on the Evolution 650 (shows twice the
     nominal value, firmware bug?)
   - add several parameters which were previously not supported
   - appended HU_FLAG_STATIC where appropriate

Sat Jul 28 19:58:11 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>
 - drivers/megatec.c: battery values for 72V UPS.

Sat Jul 28 16:38:43 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - data/driver.list, drivers/belkin-hid.c, scripts/hotplug/libhid.usermap,
   scripts/udev/nut-usbups.rules.in: Add Belkin F6C1200-UNV (older model)
   to supported devices.

Thu Jul 26 19:45:12 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - clients/upsmon.c: only change the polling frequency if the OL/OB state
   changes (code cleanup, not a functional change)

Sun Jul 22 19:18:08 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - server/upsd.c: likewise we probably shouldn't check for FD_ISSET
   either if we already know the client was disconnected.

Sun Jul 22 19:11:05 UTC 2007 / Arjen de Korte <arjen@de-korte.org>

 - server/upsd.c: don't call FD_SET in the mainloop for clients we
   already know are no longer connected.

Wed Jul 11 03:18:44 UTC 2007 / Charles Lepple <clepple@gmail.com>

 - scripts/misc: Added bash completion script for 'upsc'.

Tue Jul 10 23:57:50 UTC 2007 / Carlos Rodrigues <carlos.efr@mail.telepac.pt>

 - data/driver.list: UPSonic CXR1000 supported by megatec

Tue Jul 10 21:10:20 UTC 2007 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Changed Driver version to 0.12 and included a small TODO list in the bcmxcp.c

Tue Jul 10 13:47:01 UTC 2007 / Arnaud Quette <aquette.dev@gmail.com>

 - lib/libupsclient.pc.in, lib/libupsclient-config.in: fix a typo
   (missing "LIB" prefix on the SSL_*FLAGS)

Mon Jul  9 19:45:20 UTC 2007 / Kjell Claesson <kjell.claesson@epost.tidanet.se>

 - Patch from Oliver Wilcock.
   bcmxcp.c modified to control individual load segments (outlet.2.shutdown.return) on Powerware PW5125.

Fri Jul  6 14:28:01 UTC 2007 / Arnaud Quette <aquette.dev@gmail.com>

 - data/drivers.list: fix some separators

*** File trimmed here 5 July 2007 ***

For entries before this point, start with version 2.2.0 and work back.
